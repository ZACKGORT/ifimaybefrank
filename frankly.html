<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="An anti-scroll manifesto. A portfolio that makes you read one sentence at a time. Sentence-based navigation meets parallax storytelling.">
    <meta name="author" content="Zack Gort">
    <meta name="keywords" content="experimental portfolio, sentence navigation, UX design, interaction design, storytelling, Zack Gort">
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://ifimaybefrank.com/">
    <meta property="og:title" content="IFIMAYBEFRANK - Zack Gort">
    <meta property="og:description" content="What if reading on the web felt intentional? A sentence-based narrative interface. No endless scrolling. Just you, the story, and the space between sentences.">
    <meta property="og:image" content="https://ifimaybefrank.com/og-image.jpg">

    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://ifimaybefrank.com/">
    <meta property="twitter:title" content="IFIMAYBEFRANK - Zack Gort">
    <meta property="twitter:description" content="An anti-scroll manifesto. One sentence at a time.">
    <meta property="twitter:image" content="https://ifimaybefrank.com/og-image.jpg">
    
    <title>IFIMAYBEFRANK - Zack Gort</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Crimson+Text:ital,wght@0,400;0,500;0,600;1,400&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
/* ===================================
   CSS VARIABLES & THEMES
   =================================== */
:root {
    --bg-color: #000000;
    --ink: #ffffff;
    --ink-2: #b8b8b8;
    --ink-3: #808080;
    --accent: #daa520;
    --curve-k: 1;
    --vig-opacity: 0.85;
    --vig-inner: 30%;
    --vig-mid: 75%;
    --vig-outer: 100%;
    --edge-blur: 6px;
    --edge-mask-i: 65%;
    --edge-mask-o: 80%;
    --z-content: 0;
    --z-grain: 149;
    --z-blur: 150;
    --z-vig: 151;
    --z-ui: 220;
    --z-overlay: 300;
    --z-dropdown: 350;
    --z-rail: 210;
    --z-mobile-bottom-rail: 220;
    --z-rotate-warning: 9999;
    --bracket-color: #8b6f47;
    --bracket-hover: #daa520;
    --bracket-bg: rgba(218, 165, 32, 0.04);
    
    --text-parallax-strength: 0.03;
    --image-parallax-strength: 0.15;
    --center-magnet-strength: 0.25;
}

/* Newspaper/Ink Light Theme */
body.theme-newspaper {
    --bg-color: #faf8f3;
    --ink: #000000;
    --ink-2: #1a1a1a;
    --ink-3: #2a2a2a;
    --accent: #8b4513;
    --vig-opacity: 0.12;
    --bracket-color: #5d4e37;
    --bracket-hover: #8b4513;
    --bracket-bg: rgba(139, 69, 19, 0.03);
}

/* Academic Theme */
body.theme-academic {
    --bg-color: #ffffff;
    --ink: #000000;
    --ink-2: #1a1a1a;
    --ink-3: #333333;
    --accent: #0066cc;
    --vig-opacity: 0;
    --edge-blur: 0px;
    --bracket-color: #004080;
    --bracket-hover: #0066cc;
    --bracket-bg: rgba(0, 102, 204, 0.05);
}

/* ===================================
   THEME-SPECIFIC OVERRIDES
   =================================== */

/* Chapter Progress - Newspaper Theme */
body.theme-newspaper .chapter-bar { background: rgba(0, 0, 0, 0.12); }
body.theme-newspaper .chapter-bar:hover { background: rgba(0, 0, 0, 0.25); }
body.theme-newspaper .chapter-bar.active { background: var(--accent); }
body.theme-newspaper .chapter-bar.completed { background: rgba(139, 69, 19, 0.3); }
body.theme-newspaper .chapter-bar::after { background: rgba(245, 241, 232, 0.95); border-color: rgba(0, 0, 0, 0.12); color: var(--ink-2); }

/* Chapter Progress - Academic Theme */
body.theme-academic .chapter-bar { background: rgba(0, 0, 0, 0.15); }
body.theme-academic .chapter-bar:hover { background: rgba(0, 0, 0, 0.3); }
body.theme-academic .chapter-bar.active { background: var(--accent); }
body.theme-academic .chapter-bar.completed { background: rgba(0, 102, 204, 0.3); }
body.theme-academic .chapter-bar::after { background: rgba(255, 255, 255, 0.98); border-color: rgba(0, 0, 0, 0.15); color: var(--ink-2); }

body.theme-newspaper .nav-button, body.theme-newspaper .lens-control-container, body.theme-newspaper .mobile-bottom-rail, body.theme-newspaper .mobile-right-rail { background: rgba(245, 241, 232, 0.95); border-color: rgba(0, 0, 0, 0.12); }
body.theme-newspaper .nav-button:hover { background: rgba(139, 69, 19, 0.08); }
body.theme-newspaper .stream { color: var(--ink) !important; }
body.theme-newspaper .grain { background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMDAiIGhlaWdodD0iMzAwIj48ZmlsdGVyIGlkPSJhIj48ZmVUdXJidWxlbmNlIHR5cGU9ImZyYWN0YWxOb2lzZSIgYmFzZUZyZXF1ZW5jeT0iLjkiIG51bU9jdGF2ZXM9IjQiLz48ZmVDb2xvck1hdHJpeCB0eXBlPSJzYXR1cmF0ZSIgdmFsdWVzPSIwIi8+PC9maWx0ZXI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsdGVyPSJ1cmwoI2EpIiBvcGFjaXR5PSIuMDUiLz48L3N2Zz4='); opacity: 0.3; }
body.theme-newspaper .chapter-dropdown { background: rgba(245, 241, 232, 0.98); border-color: rgba(0, 0, 0, 0.15); }
body.theme-newspaper .chapter-item:hover { background: rgba(139, 69, 19, 0.06); }

/* Academic styles */
body.theme-academic .nav-button, body.theme-academic .lens-control-container, body.theme-academic .mobile-bottom-rail, body.theme-academic .mobile-right-rail { background: rgba(255, 255, 255, 0.98); border-color: rgba(0, 0, 0, 0.15); }
body.theme-academic .nav-button:hover { background: rgba(0, 102, 204, 0.08); }
body.theme-academic .lens-slider { background: rgba(0, 0, 0, 0.15); }
body.theme-academic .stream { color: var(--ink) !important; line-height: 1.9; }
body.theme-academic .grain, body.theme-academic .vignette, body.theme-academic .edge-blur { display: none; }
body.theme-academic .chapter-dropdown { background: rgba(255, 255, 255, 0.98); border-color: rgba(0, 0, 0, 0.2); }
body.theme-academic .chapter-item:hover { background: rgba(0, 102, 204, 0.08); }
body.theme-academic .sentence { color: #000000; }
body.theme-academic .sentence:hover { color: #000000; background: rgba(0, 102, 204, 0.1); padding: 2px 6px; border-radius: 2px; }
body.theme-academic .sentence.active { color: #ffffff; background: #0066cc; padding: 2px 6px; border-radius: 2px; text-shadow: none; }
body.theme-academic .sentence.dimmed { opacity: 0.4; color: #333333; }
body.theme-academic .chapter-break { border-top-color: rgba(0, 102, 204, 0.3); border-bottom-color: rgba(0, 102, 204, 0.3); color: var(--accent); }
body.theme-academic .image-grid-overlay { background: rgba(255, 255, 255, 0.98); }
body.theme-academic .grid-chapter-title { border-bottom-color: rgba(0, 0, 0, 0.15); }
body.theme-academic .grid-image-item { border-color: rgba(0, 0, 0, 0.2); background: #f5f5f5; }
body.theme-academic .grid-image-item:hover { border-color: var(--accent); box-shadow: 0 4px 12px rgba(0, 102, 204, 0.2); }
body.theme-academic .accessibility-btn { background: rgba(0, 0, 0, 0.05); border-color: rgba(0, 0, 0, 0.15); }
body.theme-academic .accessibility-btn:hover { background: rgba(0, 102, 204, 0.1); }
body.theme-academic .level-indicator { background: rgba(0, 0, 0, 0.15); }
body.theme-academic .level-indicator.active { background: var(--accent); }
body.theme-academic .context-menu { background: rgba(255, 255, 255, 0.98); border-color: rgba(0, 0, 0, 0.2); }
body.theme-academic .context-menu-item { color: var(--ink-2); }
body.theme-academic .context-menu-item:hover { background: rgba(0, 102, 204, 0.08); color: var(--accent); }
body.theme-academic .context-menu-item:active { background: rgba(0, 102, 204, 0.15); }
body.theme-academic .context-menu-divider { background: rgba(0, 0, 0, 0.15); }

/* Newspaper extra styles */
body.theme-newspaper .grid-chapter-title { border-bottom-color: rgba(0, 0, 0, 0.12); }
body.theme-newspaper .grid-image-item { border-color: rgba(0, 0, 0, 0.15); background: #e8e4d8; }
body.theme-newspaper .grid-image-item:hover { border-color: var(--accent); box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15); }
body.theme-newspaper .sentence { color: #000000; }
body.theme-newspaper .sentence:hover { color: #000000; background: rgba(255, 255, 255, 0.95); padding: 2px 6px; border-radius: 2px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); }
body.theme-newspaper .sentence.active { color: #ffffff; background: #000000; padding: 2px 6px; border-radius: 2px; text-shadow: none; }
body.theme-newspaper .sentence.dimmed { opacity: 0.35; color: #333333; }
body.theme-newspaper .chapter-break { border-top-color: rgba(139, 69, 19, 0.25); border-bottom-color: rgba(139, 69, 19, 0.25); color: var(--accent); }

/* Newspaper Context Menu */
body.theme-newspaper .context-menu { background: rgba(245, 241, 232, 0.98); border-color: rgba(0, 0, 0, 0.15); }
body.theme-newspaper .context-menu-item { color: var(--ink-2); }
body.theme-newspaper .context-menu-item:hover { background: rgba(139, 69, 19, 0.08); color: var(--accent); }
body.theme-newspaper .context-menu-item:active { background: rgba(139, 69, 19, 0.15); }
body.theme-newspaper .context-menu-divider { background: rgba(0, 0, 0, 0.1); }

/* ===================================
   LAYOUT MODES
   =================================== */
html, body { overscroll-behavior: none; touch-action: pan-y; }
body.layout-layered .text-layer { width: 95%; margin: 0 auto; max-width: 1400px; }
body.layout-layered .stream { color: rgba(255, 255, 255, 0.85); }
body.layout-layered .hover-image { position: absolute; left: 50%; top: 50%; }
body.layout-split .text-layer { width: 50%; margin: 0; padding-left: 6vw; }
body.layout-split .stream { color: rgba(255, 255, 255, 0.9); font-size: clamp(16px, 2vw, 28px); }
body.layout-split .hover-image { position: fixed; left: 72%; top: 50%; width: 45vw; height: 34vw; }
body:not(.cursor-preview-mode) .hover-image { display: block; }
body:not(.cursor-preview-mode) #cursorImage { display: none !important; }
body.cursor-preview-mode .hover-image { display: none !important; }
body.cursor-preview-mode #cursorImage { display: block !important; }

/* ===================================
   NAVIGATION RAILS
   =================================== */
.scroll-progress { 
    position: fixed; 
    right: 30px; 
    top: 50%; 
    transform: translateY(-50%); 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 15px; 
    z-index: var(--z-ui); 
    pointer-events: auto; 
}

/* Chapter Progress Bars */
.chapter-progress-container { 
    display: flex; 
    flex-direction: column; 
    gap: 6px; 
    padding: 10px 0; 
    align-items: center;
}

.chapter-bar { 
    width: 20px; 
    height: 4px; 
    background: rgba(255, 255, 255, 0.15); 
    border-radius: 2px; 
    cursor: pointer;
    transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
}

.chapter-bar:hover { 
    width: 32px;
    height: 6px;
    background: rgba(255, 255, 255, 0.3);
}

.chapter-bar.active { 
    background: var(--accent);
    box-shadow: 0 0 8px var(--accent);
}

.chapter-bar.active:hover {
    background: var(--accent);
    box-shadow: 0 0 12px var(--accent);
}

.chapter-bar.completed {
    background: rgba(218, 165, 32, 0.4);
}

.chapter-bar.completed:hover {
    background: rgba(218, 165, 32, 0.6);
}

.chapter-bar::after {
    content: attr(data-chapter-title);
    position: absolute;
    right: calc(100% + 12px);
    top: 50%;
    transform: translateY(-50%);
    font-family: 'Space Mono', monospace;
    font-size: 11px;
    color: var(--ink-2);
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.2s ease;
    background: rgba(0, 0, 0, 0.9);
    padding: 4px 8px;
    border-radius: 4px;
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.chapter-bar:hover::after {
    opacity: 1;
}

.nav-button { 
    width: 36px; 
    height: 36px; 
    border-radius: 50%; 
    background: rgba(255, 255, 255, 0.05); 
    border: 1px solid rgba(255, 255, 255, 0.1); 
    color: var(--ink-3); 
    cursor: pointer; 
    transition: all 0.2s ease; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-size: 14px; 
    pointer-events: auto; 
    user-select: none; 
    -webkit-user-select: none; 
    -webkit-tap-highlight-color: transparent; 
    touch-action: manipulation; 
}
.nav-button:hover { 
    background: rgba(255, 255, 255, 0.1); 
    border-color: var(--accent); 
    color: var(--accent); 
    transform: scale(1.1); 
}
.nav-button:active { transform: scale(0.95); }
.nav-button svg { width: 16px; height: 16px; fill: currentColor; }

.left-rail { 
    position: fixed; 
    left: 0; 
    top: 50%; 
    transform: translateY(-50%); 
    z-index: var(--z-rail); 
    padding: 20px 12px; 
    pointer-events: auto; 
    display: flex; 
    align-items: center; 
}
.lens-control-container { 
    background: rgba(255, 255, 255, 0.03); 
    border: 1px solid rgba(255, 255, 255, 0.08); 
    border-left: none; 
    border-radius: 0 8px 8px 0; 
    padding: 16px 8px; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 12px; 
    backdrop-filter: blur(5px); 
}
.lens-label { 
    font-family: 'Space Mono', monospace; 
    font-size: 9px; 
    color: var(--ink-3); 
    text-transform: uppercase; 
    letter-spacing: 0.05em; 
    writing-mode: vertical-rl; 
    text-orientation: mixed; 
    transform: rotate(180deg); 
}
.accessibility-controls { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 10px; 
}
.accessibility-btn { 
    width: 28px; 
    height: 28px; 
    border-radius: 4px; 
    background: rgba(255, 255, 255, 0.05); 
    border: 1px solid rgba(255, 255, 255, 0.1); 
    color: var(--ink-2); 
    cursor: pointer; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    transition: all 0.2s ease; 
}
.accessibility-btn:hover { 
    background: rgba(255, 255, 255, 0.1); 
    border-color: var(--accent); 
    color: var(--accent); 
}
.accessibility-btn:active { transform: scale(0.9); }
.accessibility-btn svg { width: 16px; height: 16px; }
.accessibility-level { 
    display: flex; 
    flex-direction: column; 
    gap: 4px; 
    padding: 8px 0; 
}
.level-indicator { 
    width: 16px; 
    height: 3px; 
    background: rgba(255, 255, 255, 0.1); 
    border-radius: 2px; 
    transition: background 0.2s ease; 
}
.level-indicator.active { background: var(--accent); }

body.theme-newspaper .accessibility-btn { 
    background: rgba(0, 0, 0, 0.05); 
    border-color: rgba(0, 0, 0, 0.1); 
}
body.theme-newspaper .accessibility-btn:hover { 
    background: rgba(139, 69, 19, 0.1); 
}
body.theme-newspaper .level-indicator { background: rgba(0, 0, 0, 0.1); }
body.theme-newspaper .level-indicator.active { background: var(--accent); }

/* ===================================
   MOBILE RAILS
   =================================== */
.mobile-right-rail { 
    display: none; 
    position: fixed; 
    right: 0; 
    top: 0; 
    bottom: 0; 
    width: 60px; 
    background: rgba(0, 0, 0, 0.8); 
    backdrop-filter: blur(10px); 
    z-index: var(--z-ui); 
    flex-direction: column; 
    align-items: center; 
    justify-content: center; 
    gap: 20px; 
    border-left: 1px solid rgba(255, 255, 255, 0.1); 
    padding: 20px 0; 
}
.mobile-bottom-rail { 
    display: none; 
    position: fixed; 
    bottom: 0; 
    left: 0; 
    right: 0; 
    background: rgba(0, 0, 0, 0.9); 
    backdrop-filter: blur(20px); 
    -webkit-backdrop-filter: blur(20px); 
    border-top: 1px solid rgba(255, 255, 255, 0.1); 
    padding: 12px 20px; 
    z-index: var(--z-mobile-bottom-rail); 
    pointer-events: auto; 
}
.mobile-nav-container { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    gap: 12px; 
    max-width: 500px; 
    margin: 0 auto; 
    width: 100%; 
}
.mobile-right-rail .mobile-nav-container { 
    flex-direction: column; 
    height: 100%; 
    justify-content: space-between; 
}
.mobile-right-rail .rail-top-group, .mobile-right-rail .rail-bottom-group { 
    display: flex; 
    flex-direction: column; 
    gap: 10px; 
    align-items: center; 
}
.mobile-nav-group { 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 4px; 
}
.mobile-nav-button { 
    width: 48px; 
    height: 48px; 
    border-radius: 12px; 
    background: rgba(255, 255, 255, 0.08); 
    border: 1px solid rgba(255, 255, 255, 0.15); 
    color: var(--accent); 
    cursor: pointer; 
    transition: all 0.2s ease; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    pointer-events: auto; 
    -webkit-tap-highlight-color: transparent; 
    user-select: none; 
    -webkit-user-select: none; 
    touch-action: manipulation; 
}
.mobile-nav-button:active { 
    transform: scale(0.92); 
    background: rgba(218, 165, 32, 0.15); 
}
.mobile-nav-button svg { width: 22px; height: 22px; fill: currentColor; }
.mobile-nav-label { 
    font-family: 'Space Mono', monospace; 
    font-size: 9px; 
    color: var(--ink-3); 
    text-transform: uppercase; 
    letter-spacing: 0.05em; 
}
.mobile-progress-container { 
    flex: 1; 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 6px; 
    padding: 0 12px; 
}
.mobile-right-rail .mobile-progress-container { 
    height: 100%; 
    width: 100%; 
    flex: 1; 
    justify-content: center; 
    padding: 20px 0; 
}
.mobile-right-rail .mobile-progress-bar { 
    width: 4px; 
    height: 100%; 
    max-height: 200px; 
}
.mobile-right-rail .mobile-progress-fill { 
    width: 100%; 
    height: 0%; 
    bottom: 0; 
    top: auto; 
    transition: height 0.3s ease; 
}
.mobile-progress-text { 
    font-family: 'Space Mono', monospace; 
    font-size: 10px; 
    color: var(--ink-2); 
    letter-spacing: 0.05em; 
}
.mobile-progress-bar { 
    width: 100%; 
    height: 4px; 
    background: rgba(255, 255, 255, 0.1); 
    border-radius: 2px; 
    position: relative; 
    overflow: hidden; 
}
.mobile-progress-fill { 
    position: absolute; 
    left: 0; 
    top: 0; 
    height: 100%; 
    background: var(--accent); 
    border-radius: 2px; 
    transition: width 0.3s ease; 
    width: 0%; 
}

body.image-active .sentence:not(.active) { opacity: 0.1; color: rgba(255, 255, 255, 0.3); }
body.image-active .sentence.active { opacity: 1; color: #fff; }
body.image-active .sentence.dimmed { opacity: 0.05; color: rgba(255, 255, 255, 0.15); }

/* ===================================
   BASE STYLES
   =================================== */
*, *::before, *::after { box-sizing: border-box; }
html { color-scheme: dark; -webkit-text-size-adjust: 100%; }
body, html { height: 100%; margin: 0; overflow-x: hidden; }
body { 
    background: var(--bg-color); 
    color: var(--ink); 
    font: 18px/1.8 'Crimson Text', Georgia, serif; 
    overflow: hidden; 
    -webkit-font-smoothing: antialiased; 
    -moz-osx-font-smoothing: grayscale; 
    -webkit-tap-highlight-color: transparent; 
    cursor: none; 
    user-select: none; 
    -webkit-user-select: none; 
    -moz-user-select: none; 
    -ms-user-select: none; 
}
body::-webkit-scrollbar { display: none; }
body { -ms-overflow-style: none; scrollbar-width: none; }
::selection { background: rgba(218, 165, 32, 0.25); color: #fff; }

/* ===================================
   FLOW MODE
   =================================== */
body.flow-mode .sentence { opacity: 0.15; transition: opacity 0.6s ease; }
body.flow-mode .sentence.active { opacity: 1; }
body.flow-mode .sentence.revealed { opacity: 0.6; }
body.flow-mode .text-layer { overflow-y: auto; height: 100vh; -webkit-overflow-scrolling: touch; }


/* Split view with active image - full opacity */
body.layout-split.image-active .sentence.dimmed { opacity: .44 !important; color: rgba(255, 255, 255, 0.9) !important; }


/* ===================================
   INTERACTION HINTS
   =================================== */
.interaction-hint { 
    position: fixed; 
    bottom: 120px; 
    left: 50%; 
    transform: translateX(-50%); 
    z-index: 9998; 
    font-family: 'Space Mono', monospace; 
    font-size: 11px; 
    letter-spacing: 0.1em; 
    text-transform: uppercase; 
    color: var(--accent); 
    opacity: 0; 
    animation: hintPulse 3s ease-in-out; 
    pointer-events: none; 
}
@keyframes hintPulse { 
    0%, 100% { opacity: 0; } 
    10%, 90% { opacity: 0.6; } 
    50% { opacity: 0.3; } 
}
body.hint-shown .interaction-hint { display: none; }



/* ===================================
   CONTEXT MENU
   =================================== */
.context-menu { 
    position: fixed; 
    z-index: calc(var(--z-overlay) + 100); 
    background: rgba(0, 0, 0, 0.95); 
    backdrop-filter: blur(20px); 
    -webkit-backdrop-filter: blur(20px); 
    border: 1px solid rgba(255, 255, 255, 0.15); 
    border-radius: 8px; 
    padding: 8px 0; 
    min-width: 200px; 
    opacity: 0; 
    transform: scale(0.95); 
    pointer-events: none; 
    transition: opacity 0.15s ease, transform 0.15s ease; 
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5); 
}
.context-menu.open { 
    opacity: 1; 
    transform: scale(1); 
    pointer-events: auto; 
}
.context-menu-item { 
    display: flex; 
    align-items: center; 
    gap: 12px; 
    padding: 10px 16px; 
    color: var(--ink-2); 
    font-family: 'Space Mono', monospace; 
    font-size: 13px; 
    cursor: pointer; 
    transition: all 0.15s ease; 
    user-select: none; 
}
.context-menu-item:hover { 
    background: rgba(255, 255, 255, 0.08); 
    color: var(--accent); 
}
.context-menu-item:active { background: rgba(255, 255, 255, 0.15); }
.context-menu-item.context-menu-info { 
    cursor: default; 
    opacity: 0.5; 
    font-size: 11px; 
    padding: 8px 16px; 
}
.context-menu-item.context-menu-info:hover { 
    background: transparent; 
    color: var(--ink-2); 
}
.ctx-icon { font-size: 16px; width: 20px; text-align: center; }
.context-menu-divider { 
    height: 1px; 
    background: rgba(255, 255, 255, 0.1); 
    margin: 6px 8px; 
}

/* ===================================
   VISUAL EFFECTS
   =================================== */
.edge-blur { 
    position: fixed; 
    inset: 0; 
    pointer-events: none; 
    z-index: var(--z-blur); 
    backdrop-filter: blur(var(--edge-blur)); 
    -webkit-backdrop-filter: blur(var(--edge-blur)); 
    mask: radial-gradient(100% 64% at 50% 50%, transparent var(--edge-mask-i), rgb(255 255 255 / 0.98) var(--edge-mask-o)); 
    -webkit-mask: radial-gradient(100% 64% at 50% 50%, transparent var(--edge-mask-i), rgb(255 255 255 / 0.98) var(--edge-mask-o)); 
}
.vignette { 
    position: fixed; 
    inset: 0; 
    pointer-events: none; 
    z-index: var(--z-vig); 
    background: radial-gradient(120% 90% at 50% 50%, #fff0 var(--vig-inner), rgb(0 0 0 / 0.55) var(--vig-mid), rgb(0 0 0 / 0.9) var(--vig-outer)); 
    opacity: calc(var(--vig-opacity) * var(--curve-k)); 
}
body::after { 
    content: ""; 
    position: fixed; 
    inset: 0; 
    pointer-events: none; 
    z-index: var(--z-grain); 
    opacity: 0.08; 
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.45'/%3E%3C/svg%3E"); 
    background-size: 120px 120px; 
}

/* ===================================
   PARALLAX & LAYERS
   =================================== */
.curved { 
    position: fixed; 
    inset: 0; 
    transform-style: preserve-3d; 
    transform: perspective(1000px) translateZ(calc(-200px * var(--curve-k))) scale(calc(1 + var(--curve-k) * 0.06)); 
    will-change: transform; 
    z-index: var(--z-content); 
}
.parallax-container { 
    position: relative; 
    width: 100%; 
    height: 100%; 
    overflow: hidden; 
}
.text-layer { 
    position: relative; 
    z-index: 10; 
    padding: 15vh 8vw 25vh; 
    max-width: 99%; 
    margin: 0 auto; 
    transform-style: preserve-3d; 
    will-change: transform; 
    transition: transform 0.1s linear; 
}
.image-layer { 
    position: fixed; 
    inset: 0; 
    z-index: 5; 
    pointer-events: none; 
    transform-style: preserve-3d; 
    will-change: transform; 
    transition: transform 0.1s linear; 
}
.stream { 
    font-size: clamp(18px, 2.5vw, 32px); 
    line-height: 1.8; 
    letter-spacing: -0.01em; 
    max-width: 100%; 
    color: rgba(255, 255, 255, 0.85); 
}
.sentence { 
    display: inline; 
    transition: opacity 0.3s ease, color 0.3s ease; 
    cursor: none; 
    position: relative; 
    z-index: 2; 
    letter-spacing: -0.01em; 
}
.sentence.active { 
    color: #fff; 
    opacity: 1; 
    text-shadow: 0 0 20px rgba(218, 165, 32, 0.3); 
    background: rgba(0, 0, 0, 0.95); 
    padding: 2px 6px; 
    border-radius: 2px; 
}
.sentence.dimmed { opacity: 0.4; color: rgba(255, 255, 255, 0.5); }

.bullet-item, .numbered-bullet-item { 
    display: block; 
    margin: 0.5em 0; 
    padding-left: 1.5em; 
    position: relative; 
}
.bullet-marker, .numbered-marker { 
    position: absolute; 
    left: 0; 
    color: var(--accent); 
    font-weight: 600; 
}
.bullet-marker { font-size: 1.2em; line-height: 1.5; }
.numbered-marker { 
    font-family: 'Space Mono', monospace; 
    font-size: 0.85em; 
}

.line-break-spacer { 
    display: inline; 
    pointer-events: none; 
    background: none !important; 
    padding: 0 !important; 
}

/* ===================================
   CHAPTER BREAKS
   =================================== */
.chapter-break { 
    display: block; 
    margin: 3em 0 2em; 
    padding: 1.5em 0; 
    border-top: 1px solid rgba(218, 165, 32, 0.2); 
    border-bottom: 1px solid rgba(218, 165, 32, 0.2); 
    text-align: center; 
    font-family: 'Space Mono', monospace; 
    font-size: 11px; 
    letter-spacing: 0.15em; 
    text-transform: uppercase; 
    color: var(--accent); 
    opacity: 0.6; 
    cursor: pointer; 
    transition: all 0.3s ease; 
    pointer-events: auto; 
}
.chapter-break:hover { 
    opacity: 1; 
    background: rgba(218, 165, 32, 0.05); 
    padding: 1.5em 1em; 
}
.chapter-break .chapter-number { 
    display: block; 
    font-size: 0.7em; 
    margin-bottom: 0.5em; 
    color: var(--ink-3); 
}
.chapter-break .chapter-title { 
    display: block; 
    font-size: 1.2em; 
    font-weight: 700; 
    letter-spacing: 0.1em; 
}

/* ===================================
   BRACKETS
   =================================== */
.bracket-trigger { 
    all: unset; 
    cursor: none; 
    font-family: 'Space Mono', 'Courier New', monospace; 
    font-size: 0.65em; 
    color: var(--bracket-color); 
    letter-spacing: 0.02em; 
    transition: all 0.2s ease; 
    border-bottom: 1px dotted rgba(139, 111, 71, 0.5); 
    padding-bottom: 1px; 
    display: inline; 
    vertical-align: baseline; 
    line-height: inherit; 
    margin: 0 0.1em; 
}
.bracket-trigger:hover { 
    color: var(--bracket-hover); 
    opacity: 1; 
    border-bottom-color: var(--bracket-hover); 
}
.bracket-trigger.expanded { opacity: 0.5; }
.bracket-content { 
    display: none; 
    font-size: 0.8em; 
    color: rgba(184, 184, 184, 0.8); 
    font-style: italic; 
    line-height: inherit; 
    padding-left: 0.2em; 
    margin-left: 0.2em; 
    border-left: 1px solid rgba(218, 165, 32, 0.5); 
    padding-right: 0.2em; 
    background: rgba(218, 165, 32, 0.02); 
    animation: bracketFadeIn 0.3s ease-out; 
}
.bracket-content.visible { display: inline; }

@keyframes bracketFadeIn { 
    from { opacity: 0; transform: translateY(-4px); } 
    to { opacity: 1; transform: translateY(0); } 
}

/* ===================================
   IMAGE TRIGGERS & HOVER
   =================================== */
.image-trigger { 
    position: relative; 
    text-decoration: none; 
    border-bottom: 1px dotted var(--accent); 
    cursor: help; 
    transition: all 0.2s ease; 
    opacity: 0.9; 
}
.image-trigger:hover { 
    color: var(--accent); 
    border-bottom-style: solid; 
    opacity: 1; 
}

.hover-image { 
    position: absolute; 
    z-index: 1; 
    pointer-events: none; 
    opacity: 0; 
    transition: opacity 0.4s cubic-bezier(0.25, 1, 0.5, 1), transform 0.1s linear; 
    width: 1400px; 
    height: 1050px; 
    border-radius: 8px; 
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4); 
    transform: translate(-50%, -50%) scale(0.95); 
    filter: brightness(0.9) contrast(1.05); 
    will-change: transform, opacity; 
    left: 50%; 
    top: 50%; 
}
.hover-image.active { 
    opacity: 0.6; 
    transform: translate(-50%, -50%) scale(1); 
}
.hover-image img { 
    display: block; 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    border-radius: 8px; 
}

#cursorImage { 
    position: fixed; 
    pointer-events: none; 
    z-index: 9999; 
    transform: translate(-50%, -50%); 
    opacity: 0; 
    transition: opacity 0.3s ease, width 0.3s ease, height 0.3s ease; 
    border-radius: 4px; 
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3); 
    width: 400px; 
    height: 300px; 
    object-fit: cover; 
    display: none; 
    top: 0; 
    left: 0; 
}
#cursorImage.active { opacity: 1; }
#cursorImage.enlarged { 
    width: 600px; 
    height: 450px; 
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); 
}

/* ===================================
   HEADER
   =================================== */
.header { 
    position: fixed; 
    top: 0; 
    left: 0; 
    right: 0; 
    z-index: var(--z-ui); 
    padding: clamp(16px, 2vh, 28px) clamp(20px, 4vw, 50px); 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    pointer-events: none; 
}
.brand-container { position: relative; pointer-events: auto; }
.header-right { display: flex; align-items: center; gap: 12px; }
.brand { 
    font-family: 'Space Mono', monospace; 
    font-size: 11px; 
    letter-spacing: 0.08em; 
    text-transform: uppercase; 
    color: var(--ink-3); 
    padding: 6px 10px; 
    border-radius: 3px; 
    transition: all 0.2s ease; 
    text-decoration: none; 
    background: rgba(255, 255, 255, 0.015); 
    border: 1px solid rgba(255, 255, 255, 0.06); 
    cursor: pointer; 
    display: flex; 
    align-items: center; 
    gap: 8px; 
}
.brand:hover { 
    background: rgba(255, 255, 255, 0.04); 
    color: var(--ink); 
    border-color: var(--accent); 
}
.brand:active { transform: scale(0.95); }
.brand-dropdown-icon { 
    font-size: 10px; 
    transition: transform 0.2s ease; 
}
.brand.open .brand-dropdown-icon { transform: rotate(180deg); }

/* ===================================
   CHAPTER DROPDOWN
   =================================== */
.chapter-dropdown { 
    position: absolute; 
    top: calc(100% + 8px); 
    left: 0; 
    min-width: 280px; 
    background: rgba(10, 10, 10, 0.95); 
    backdrop-filter: blur(20px); 
    -webkit-backdrop-filter: blur(20px); 
    border: 1px solid rgba(255, 255, 255, 0.1); 
    border-radius: 8px; 
    padding: 8px 0; 
    opacity: 0; 
    visibility: hidden; 
    transform: translateY(-10px); 
    transition: all 0.3s cubic-bezier(0.25, 1, 0.5, 1); 
    z-index: var(--z-dropdown); 
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); 
    max-height: 70vh; 
    display: flex; 
    flex-direction: column; 
}
.chapter-dropdown.open { 
    opacity: 1; 
    visibility: visible; 
    transform: translateY(0); 
}
.chapter-dropdown-header { 
    padding: 12px 16px; 
    border-bottom: 1px solid rgba(255, 255, 255, 0.08); 
    margin-bottom: 8px; 
    flex-shrink: 0; 
}
.chapter-dropdown-header h3 { 
    font-family: 'Space Mono', monospace; 
    font-size: 10px; 
    letter-spacing: 0.1em; 
    text-transform: uppercase; 
    color: var(--ink-3); 
    margin: 0; 
    font-weight: 400; 
}
.chapter-dropdown-list { 
    overflow-y: auto; 
    padding: 0; 
    margin: 0; 
    list-style: none; 
    overscroll-behavior: contain; 
    -webkit-overflow-scrolling: touch; 
}
.chapter-dropdown-list::-webkit-scrollbar { width: 4px; }
.chapter-dropdown-list::-webkit-scrollbar-track { background: rgba(255, 255, 255, 0.05); }
.chapter-dropdown-list::-webkit-scrollbar-thumb { 
    background: rgba(255, 255, 255, 0.15); 
    border-radius: 2px; 
}
.chapter-item { 
    padding: 10px 16px; 
    cursor: pointer; 
    transition: all 0.2s ease; 
    display: flex; 
    align-items: center; 
    gap: 12px; 
}
.chapter-item:hover { background: rgba(218, 165, 32, 0.08); }
.chapter-item.active { 
    background: rgba(218, 165, 32, 0.12); 
    border-left: 2px solid var(--accent); 
}
.chapter-item-number { 
    font-family: 'Space Mono', monospace; 
    font-size: 10px; 
    color: var(--ink-3); 
    min-width: 40px; 
}
.chapter-item-title { 
    font-family: 'Crimson Text', serif; 
    font-size: 14px; 
    color: var(--ink-2); 
    font-style: italic; 
}
.chapter-item.active .chapter-item-title { 
    color: var(--accent); 
    font-style: normal; 
}
.chapter-item-progress { 
    margin-left: auto; 
    font-family: 'Space Mono', monospace; 
    font-size: 9px; 
    color: var(--ink-3); 
    background: rgba(255, 255, 255, 0.05); 
    padding: 2px 6px; 
    border-radius: 2px; 
}

/* ===================================
   HEADER BUTTONS
   =================================== */
.preview-toggle, .layout-toggle, .theme-toggle { pointer-events: auto; }
.preview-button, .layout-button, .grid-toggle-btn, .theme-button { 
    background: rgba(255, 255, 255, 0.015); 
    border: 1px solid rgba(255, 255, 255, 0.06); 
    padding: 8px 12px; 
    border-radius: 3px; 
    cursor: pointer; 
    transition: all 0.2s ease; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    font-family: 'Space Mono', monospace; 
    font-size: 10px; 
    color: var(--ink-3); 
    gap: 6px; 
    pointer-events: auto; 
}
.preview-button:hover, .layout-button:hover, .grid-toggle-btn:hover, .theme-button:hover { 
    background: rgba(255, 255, 255, 0.04); 
    border-color: rgba(255, 255, 255, 0.12); 
}
.preview-button:active, .layout-button:active, .grid-toggle-btn:active, .theme-button:active { 
    transform: scale(0.95); 
}
.preview-button.active { 
    border-color: var(--accent); 
    color: var(--accent); 
}

.layout-icon { 
    width: 24px; 
    height: 20px; 
    position: relative; 
    display: flex; 
    flex-direction: column; 
    justify-content: space-between; 
}
.layout-icon.layered::before, .layout-icon.layered::after { 
    content: ''; 
    display: block; 
    width: 100%; 
    height: 6px; 
    background: var(--ink-3); 
    border-radius: 1px; 
    transition: all 0.3s ease; 
}
.layout-icon.layered::after { 
    opacity: 0.5; 
    margin-top: -4px; 
}
.layout-icon.split::before, .layout-icon.split::after { 
    content: ''; 
    display: block; 
    border-radius: 1px; 
    transition: all 0.3s ease; 
}
.layout-icon.split::before { 
    width: 10px; 
    height: 100%; 
    background: var(--ink-3); 
}
.layout-icon.split::after { 
    width: 10px; 
    height: 100%; 
    background: var(--ink-3); 
    margin-left: 4px; 
    opacity: 0.5; 
}
.grid-toggle-btn { 
    text-transform: uppercase; 
    letter-spacing: 0.05em; 
}

/* ===================================
   IMAGE GRID OVERLAY
   =================================== */
.image-grid-overlay { 
    position: fixed; 
    inset: 0; 
    z-index: var(--z-overlay); 
    background: rgba(5, 5, 5, 0.96); 
    backdrop-filter: blur(15px); 
    -webkit-backdrop-filter: blur(15px); 
    display: none; 
    flex-direction: column; 
    opacity: 0; 
    transition: opacity 0.3s ease; 
    overflow-y: auto; 
}
.image-grid-overlay.open { 
    display: flex; 
    opacity: 1; 
}

.close-hotspot { 
    position: fixed; 
    top: 0; 
    right: 0; 
    width: 25vw; 
    height: 25vh; 
    min-width: 150px; 
    min-height: 150px; 
    z-index: calc(var(--z-overlay) + 10); 
    cursor: none; 
    display: none; 
    pointer-events: auto; 
}
.grid-close-hotspot { 
    z-index: calc(var(--z-overlay) + 10); 
    display: none; 
}
body.grid-open .grid-close-hotspot { display: block; }
.split-close-hotspot { 
    z-index: calc(var(--z-ui) + 10); 
    display: none !important; 
}
.rotate-close-hotspot { 
    z-index: calc(var(--z-rotate-warning) + 1); 
    display: none; 
}
@media (orientation: portrait) { 
    body.layout-split .rotate-close-hotspot { display: block; } 
}

#cursor.close-mode { 
    width: 60px; 
    height: 60px; 
    border-color: var(--accent); 
    background: rgba(218, 165, 32, 0.15); 
}
#cursor.close-mode::before { 
    content: '‚úï'; 
    position: absolute; 
    top: 50%; 
    left: 50%; 
    transform: translate(-50%, -50%); 
    font-size: 28px; 
    font-weight: bold; 
    color: var(--accent); 
    line-height: 1; 
}
body.theme-newspaper #cursor.close-mode { 
    border-color: var(--accent); 
    background: rgba(139, 69, 19, 0.15); 
}
body.theme-newspaper #cursor.close-mode::before { color: var(--accent); }

.grid-content { 
    padding: 100px 5vw; 
    max-width: 1600px; 
    margin: 0 auto; 
    width: 100%; 
    will-change: transform; 
    transition: transform 0.1s linear; 
}
.grid-chapter-section { margin-bottom: 60px; }
.grid-chapter-title { 
    font-family: 'Space Mono', monospace; 
    font-size: 12px; 
    color: var(--accent); 
    text-transform: uppercase; 
    letter-spacing: 0.15em; 
    margin-bottom: 24px; 
    padding-bottom: 12px; 
    border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
    opacity: 0.7; 
}
.grid-images-container { 
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); 
    gap: 24px; 
}
.grid-image-item { 
    position: relative; 
    aspect-ratio: 4/3; 
    border-radius: 6px; 
    overflow: hidden; 
    cursor: pointer; 
    border: 1px solid rgba(255, 255, 255, 0.1); 
    transition: all 0.3s ease; 
    background: #111; 
}
.grid-image-item:hover { 
    transform: scale(1.02); 
    border-color: var(--accent); 
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5); 
    z-index: 2; 
}
.grid-image-item img { 
    width: 100%; 
    height: 100%; 
    object-fit: cover; 
    opacity: 0.9; 
    transition: opacity 0.3s ease; 
}
.grid-image-item:hover img { 
    opacity: 0.4; 
    filter: blur(2px); 
}
.grid-image-caption { 
    position: absolute; 
    inset: 0; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    padding: 20px; 
    text-align: center; 
    opacity: 0; 
    transition: opacity 0.2s ease; 
    pointer-events: none; 
}
.grid-image-item:hover .grid-image-caption { opacity: 1; }
.caption-text { 
    color: #fff; 
    text-shadow: 0 0 20px rgba(218, 165, 32, 0.3); 
    background: rgba(0, 0, 0, 0.85); 
    padding: 8px 12px; 
    border-radius: 4px; 
    font-family: 'Crimson Text', serif; 
    font-size: 16px; 
    line-height: 1.4; 
}

/* ===================================
   CUSTOM CURSOR
   =================================== */
#cursor { 
    position: fixed; 
    top: 0; 
    left: 0; 
    width: 20px; 
    height: 20px; 
    border: 1px solid rgba(255, 255, 255, 0.5); 
    border-radius: 50%; 
    pointer-events: none; 
    z-index: 9999; 
    transform: translate3d(-50px, -50px, 0) translate(-50%, -50%); 
    transition: width 0.25s, height 0.25s, background-color 0.25s, border-color 0.25s, opacity 0.25s; 
    mix-blend-mode: difference; 
    will-change: transform; 
}
#cursor.hovering { 
    width: 36px; 
    height: 36px; 
    background-color: rgba(255, 255, 255, 0.08); 
    border-color: var(--accent); 
}
#cursor.pointer { 
    width: 14px; 
    height: 14px; 
    background-color: rgba(255, 255, 255, 0.7); 
}
#cursor.has-image { opacity: 0; }

/* ===================================
   SCROLL HINT
   =================================== */
.scroll-hint { 
    position: fixed; 
    bottom: 40px; 
    left: 50%; 
    transform: translateX(-50%); 
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    gap: 8px; 
    z-index: var(--z-ui); 
    opacity: 0; 
    animation: fadeInOut 4s ease-in-out; 
    pointer-events: none; 
}
.scroll-hint-icon { 
    width: 24px; 
    height: 24px; 
    border-right: 2px solid rgba(255, 255, 255, 0.4); 
    border-bottom: 2px solid rgba(255, 255, 255, 0.4); 
    transform: rotate(45deg); 
    animation: bounce 1.5s ease-in-out infinite; 
}
.scroll-hint-text { 
    font-family: 'Space Mono', monospace; 
    font-size: 10px; 
    letter-spacing: 0.1em; 
    text-transform: uppercase; 
    color: var(--ink-3); 
}

/* ===================================
   ROTATE WARNING
   =================================== */
.rotate-warning { 
    position: fixed; 
    inset: 0; 
    z-index: var(--z-rotate-warning); 
    background: rgba(0,0,0,0.95); 
    backdrop-filter: blur(10px); 
    display: none; 
    flex-direction: column; 
    align-items: center; 
    justify-content: center; 
    text-align: center; 
    padding: 20px; 
    color: var(--accent); 
}
.rotate-warning svg { 
    width: 48px; 
    height: 48px; 
    fill: currentColor; 
    margin-bottom: 20px; 
    animation: rotateIcon 2s infinite ease-in-out; 
}
.rotate-warning p { 
    font-family: 'Space Mono', monospace; 
    font-size: 14px; 
    color: var(--ink); 
    max-width: 300px; 
    line-height: 1.6; 
}
@keyframes rotateIcon { 
    0% { transform: rotate(0deg); } 
    25% { transform: rotate(-90deg); } 
    75% { transform: rotate(-90deg); } 
    100% { transform: rotate(0deg); } 
}
@keyframes bounce { 
    0%, 100% { transform: rotate(45deg) translateY(0); } 
    50% { transform: rotate(45deg) translateY(8px); } 
}
@keyframes fadeInOut { 
    0%, 100% { opacity: 0; } 
    20%, 80% { opacity: 1; } 
}
@media (orientation: portrait) { 
    body.layout-split .rotate-warning { display: flex; } 
}
.rotate-warning.visible { display: flex; }

/* ===================================
   RESPONSIVE BREAKPOINTS
   =================================== */
@media (max-height: 500px) and (orientation: landscape) {
    .scroll-progress { display: none; }
    .left-rail { display: flex; padding: 10px 4px; }
    .mobile-bottom-rail { display: none; }
    .mobile-right-rail { display: flex; }
    .mobile-nav-button { width: 36px; height: 36px; }
    .mobile-progress-text { font-size: 9px; }
    .scroll-hint { display: none; }
    .text-layer { padding: 10vh 8vw 20vh; max-width: 90%; }
    .header { padding: 10px 20px; }
    .stream { font-size: clamp(16px, 3vw, 24px); }
    .preview-toggle { display: none; }
}

@media (max-width: 768px) {
    .scroll-progress { display: none; }
    .left-rail { display: flex; }
    .mobile-bottom-rail { display: flex; }
    .scroll-hint { display: none; }
    .text-layer { padding: 12vh 6vw 20vh 50px; max-width: 95%; }
    .stream { font-size: clamp(16px, 4vw, 28px); }
    .hover-image { width: 800px; height: 600px; }
    .chapter-dropdown { min-width: 240px; left: -10px; }
    .grid-images-container { grid-template-columns: repeat(4, 1fr); gap: 8px; }
    .grid-content { padding: 100px 10vw; }
    body.layout-split .text-layer { width: 100%; padding-left: 50px; padding-right: 20px; }
    body.layout-split .hover-image { 
        position: absolute; 
        left: 50%; 
        top: 50%; 
        width: 800px; 
        height: 600px; 
        transform: translate(-50%, -50%) scale(0.95); 
    }
    @media (pointer: coarse) { 
        #cursor { display: none !important; } 
    }
    * { -webkit-tap-highlight-color: rgba(218, 165, 32, 0.2); }
    .nav-button { -webkit-tap-highlight-color: rgba(218, 165, 32, 0.3); }
}

@media (prefers-reduced-motion: reduce) {
    .edge-blur { 
        backdrop-filter: none; 
        -webkit-backdrop-filter: none; 
    }
    * { 
        animation: none !important; 
        transition: none !important; 
    }
}
    </style>
</head>
<body>
    <!-- Context Menu -->
    <div class="context-menu" id="contextMenu" aria-hidden="true">
        <div class="context-menu-item" id="ctxNextChapter">
            <span class="ctx-icon">‚Üí</span>
            <span>Next Chapter</span>
        </div>
        <div class="context-menu-item" id="ctxPrevChapter">
            <span class="ctx-icon">‚Üê</span>
            <span>Previous Chapter</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="ctxResetProgress">
            <span class="ctx-icon">‚Üë</span>
            <span>Back to Top</span>
        </div>
        <div class="context-menu-item" id="ctxToggleTheme">
            <span class="ctx-icon" id="ctxThemeIcon">‚òÄÔ∏è</span>
            <span id="ctxThemeText">Light Theme</span>
        </div>
        <div class="context-menu-divider"></div>
        <div class="context-menu-item" id="ctxCopyLink">
            <span class="ctx-icon">üîó</span>
            <span>Copy Link</span>
        </div>
        <div class="context-menu-item" id="ctxShare">
            <span class="ctx-icon">‚Üó</span>
            <span>Share</span>
        </div>
    </div>

    <div class="interaction-hint" id="interactionHint">Click or tap to begin</div>
    
    <!-- Close Hotspots -->
    <div class="close-hotspot grid-close-hotspot" id="gridCloseHotspot" aria-label="Move cursor here to close (top-right corner)"></div>
    <div class="close-hotspot split-close-hotspot" id="splitCloseHotspot" aria-label="Move cursor here to close (top-right corner)"></div>
    <div class="close-hotspot rotate-close-hotspot" id="rotateCloseHotspot" aria-label="Move cursor here to close (top-right corner)"></div>
    
    <!-- Rotate Warning -->
    <div class="rotate-warning">
        <svg viewBox="0 0 24 24">
            <path d="M4 7.59l5-5c.78-.78 2.05-.78 2.83 0L20 10.76c.78.78.78 2.05 0 2.83L11.83 21.76c-.78.78-2.05.78-2.83 0l-5-5c-.78-.78-.78-2.05 0-2.83L4 7.59zM9 19.17l8.17-8.17L9 2.83 2.83 9 9 19.17zM17 12h-2v2h2v-2zm0-4h-2v2h2V8zm0-4h-2v2h2V4z"/>
        </svg>
        <p>Please rotate your device to landscape for Split View.</p>
    </div>

    <!-- Image Grid Overlay -->
    <div class="image-grid-overlay" id="imageGridOverlay" aria-hidden="true">
        <div class="grid-content" id="gridContent"></div>
    </div>

    <!-- Custom Cursor -->
    <div id="cursor" aria-hidden="true"></div>
    <img id="cursorImage" alt="Preview" aria-hidden="true">
    
    <!-- Left Rail (Accessibility Controls) -->
    <div class="left-rail" aria-hidden="true">
        <div class="lens-control-container">
            <span class="lens-label">Accessibility</span>
            <div class="accessibility-controls">
                <button class="accessibility-btn" id="accessibilityIncrease" aria-label="Increase accessibility" title="Increase">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
                <div class="accessibility-level" id="accessibilityLevel">
                    <div class="level-indicator"></div>
                    <div class="level-indicator"></div>
                    <div class="level-indicator active"></div>
                    <div class="level-indicator"></div>
                    <div class="level-indicator"></div>
                </div>
                <button class="accessibility-btn" id="accessibilityDecrease" aria-label="Decrease accessibility" title="Decrease">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>
    
    <!-- Mobile Bottom Rail -->
    <div class="mobile-bottom-rail" aria-label="Mobile navigation">
        <div class="mobile-nav-container">
            <div class="mobile-nav-group">
                <button class="mobile-nav-button" id="mobilePrevSentenceBtn" title="Previous Sentence" aria-label="Previous Sentence">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6 1.41 1.41z"/></svg>
                </button>
                <span class="mobile-nav-label">Prev</span>
            </div>
            
            <div class="mobile-progress-container">
                <span class="mobile-progress-text" id="mobileProgressText">0 / 0</span>
                <div class="mobile-progress-bar">
                    <div class="mobile-progress-fill" id="mobileProgressFill"></div>
                </div>
            </div>
            
            <div class="mobile-nav-group">
                <button class="mobile-nav-button" id="mobileNextSentenceBtn" title="Next Sentence" aria-label="Next Sentence">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                </button>
                <span class="mobile-nav-label">Next</span>
            </div>
        </div>
    </div>

    <!-- Mobile Right Rail (Landscape) -->
    <div class="mobile-right-rail" aria-label="Mobile navigation landscape">
        <div class="mobile-nav-container">
            <div class="rail-top-group"></div>
            <div class="mobile-progress-container">
                <div class="mobile-progress-bar">
                    <div class="mobile-progress-fill" id="landProgressFill"></div>
                </div>
            </div>
            <div class="rail-bottom-group">
                <div class="mobile-nav-group">
                    <button class="mobile-nav-button" id="landPrevBtn" title="Previous Sentence" aria-label="Previous Sentence">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6 1.41 1.41z"/></svg>
                    </button>
                </div>
                <div class="mobile-nav-group">
                    <button class="mobile-nav-button" id="landNextBtn" title="Next Sentence" aria-label="Next Sentence">
                        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Header -->
    <header class="header">
        <div class="brand-container">
            <div class="brand" id="brandLogo" aria-label="Open chapter menu">
                <span>If I May Be Frank</span>
                <span class="brand-dropdown-icon">‚ñº</span>
            </div>
            <div class="chapter-dropdown" id="chapterDropdown" aria-hidden="true">
                <div class="chapter-dropdown-header">
                    <h3>Chapters</h3>
                </div>
                <ul class="chapter-dropdown-list" id="chapterDropdownList"></ul>
            </div>
        </div>

        <div class="header-right">
            <button class="grid-toggle-btn" id="gridToggleBtn" aria-label="Toggle Image Grid">
                <span>Display</span>
                <span style="font-size: 1.2em;">‚ñ¶</span>
            </button>
            <div class="layout-toggle">
                <button id="layoutToggle" class="layout-button" aria-label="Toggle layout mode" title="Switch layout">
                    <span class="layout-icon layered"></span>
                </button>
            </div>
            <div class="theme-toggle">
                <button id="themeToggle" class="theme-button" aria-label="Toggle theme" title="Switch theme (T)">
                    <span class="theme-icon">‚òÄÔ∏è</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Visual Effects -->
    <div class="edge-blur" aria-hidden="true"></div>
    <div class="vignette" aria-hidden="true"></div>

    <!-- Desktop Navigation -->
    <div class="scroll-progress" aria-label="Navigation controls">
        <button class="nav-button prev-sentence" id="prevSentenceBtn" title="Previous Sentence (‚Üë/k)" aria-label="Previous Sentence">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6 1.41 1.41z"/></svg>
        </button>
        <div class="chapter-progress-container" id="chapterProgressContainer"></div>
        <button class="nav-button next-sentence" id="nextSentenceBtn" title="Next Sentence (‚Üì/j)" aria-label="Next Sentence">
            <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z"/></svg>
        </button>
    </div>

    <div class="scroll-hint" aria-hidden="true">
        <div class="scroll-hint-icon"></div>
        <span class="scroll-hint-text">Scroll ¬∑ Press P ¬∑ Long-press to free scroll</span>
    </div>

    <!-- Main Content -->
    <main class="curved">
        <div class="parallax-container">
            <div id="imageLayer" class="image-layer">
                <div id="hoverImage" class="hover-image" role="tooltip" aria-hidden="true">
                    <img src="" alt="" id="hoverImageImg" loading="lazy">
                </div>
            </div>
            <div id="textLayer" class="text-layer">
                <article class="stream" id="stream" role="article"></article>
            </div>
        </div>
    </main>

    <script>
      // ===================================
      // IFIMAYBEFRANK - Complete JavaScript
      // ===================================
      
      // ===================================
      // CONFIGURATION & CONSTANTS
      // ===================================
      const CONFIG = {
          TAIL_LENGTH: 12,
          CURSOR_SMOOTHING: 0.35,
          IMAGE_HOVER_DELAY: 120,
          TEXT_PARALLAX_STRENGTH: 0.03,
          IMAGE_PARALLAX_STRENGTH: 0.15,
          CENTER_MAGNET_STRENGTH: 0.25,
          PARALLAX_DAMPING: 0.1,
          SCROLL_THRESHOLD: 30,
          SCROLL_COOLDOWN: 100,
          LONG_PRESS_DURATION: 500,
          FLICK_THRESHOLD: 50
      };
      
      // ===================================
      // STATE MANAGEMENT
      // ===================================
      const state = {
          // UI State
          hoveredSentence: null,
          expandedBrackets: new Set(),
          imageActive: false,
          layoutMode: 'layered',
          previewMode: 'background',
          
          // Navigation State
          currentSentenceIndex: -1,
          currentChapterIndex: 0,
          allSentenceElements: [],
          chapterStartIndices: [],
          gridImages: [],
          
          // Mouse & Touch State
          mouseX: 0,
          mouseY: 0,
          currentTriggerRect: null,
          imageTimeout: null,
          
          // Interaction State
          isTouch: false,
          lastInteractionWasTouch: false,
          scrollCooldownActive: false,
          spacebarPressed: false,
          
          // Touch State
          touchStartY: 0,
          touchStartX: 0,
          touchMoved: false
      };
      
      // Cursor State
      const cursor = {
          x: 0,
          y: 0,
          targetX: 0,
          targetY: 0,
          element: null,
          imageElement: null,
          currentImageElement: null
      };
      
      // Parallax State
      const parallax = {
          text: { x: 0, y: 0, targetX: 0, targetY: 0 },
          image: { x: 0, y: 0, targetX: 0, targetY: 0 }
      };
      
      // ===================================
      // DATA: CHAPTERS
      // ===================================
      const chapters = [
          { id: 0, title: "Introduction", startText: "UX is dead." },
          { id: 1, title: "About Me", startText: "I think." },
          { id: 2, title: "BNY Mellon", startText: "The client was BNY Melon" },
          { id: 3, title: "GNC", startText: "General Nutrition Centers." },
          { id: 4, title: "Contact", startText: "Yeah, so if any creative teams" }
      ];
      
      // ===================================
      // DATA: IMAGE MAP (Sourced from zackgort.html)
      // ===================================
      const imageMap = {
          // Intro
          'UX is dead': 'https://i.ibb.co/cSQCgNQ/work1.webp',
          'Experience Design': 'https://i.ibb.co/kDXnBz5/1-p-XU6-Sp-Y7-Mx-MKiyf-VI-976g.gif',
          'find money': 'https://i.ibb.co/XkM2hn8n/bny1.png',
          'spend money': 'https://i.ibb.co/pBMMxY1Z/11.webp',
          'invest money': 'https://i.ibb.co/wZY2bhKF/bny4.png',
          'Accessibility': 'https://i.ibb.co/Z69xjMQY/tiktok-cat.gif',
          'Creative Coding': 'https://i.ibb.co/RCnjfFv/6105c90759377c59c854a562-ZAX02142.jpg',
          'TikTok For Business': 'https://i.ibb.co/9qFzTQH/tiktok-proto-gif.gif',
      
          // BNY Mellon
          'BNY Melon': 'https://i.ibb.co/XkM2hn8n/bny1.png',
          'Pershing X': 'https://i.ibb.co/vvMZmq94/bny2.png',
          'Wove': 'https://i.ibb.co/xS49C07B/bny3.png',
          'dashboard': 'https://i.ibb.co/wZY2bhKF/bny4.png',
          'disconnected tools': 'https://i.ibb.co/FJNG1jC/14.jpg',
          'No Artificial Intelligence': 'https://i.ibb.co/gtQLYJQ/17.jpg',
          'legacy application': 'https://i.ibb.co/dcXH5fn/13.jpg',
          'Product Design Lead': 'https://i.ibb.co/HGv7ymj/4.jpg',
      
          // GNC
          'General Nutrition Centers': 'https://i.ibb.co/cSQCgNQY/work1.webp',
          'GNC': 'https://i.ibb.co/pBMMxY1Z/11.webp',
          'This is the Whey': 'https://i.ibb.co/7N2rDqrN/8.webp',
          'e-commerce ecosystem': 'https://i.ibb.co/vx76zjgf/10.webp',
          'market research': 'https://i.ibb.co/spHgPH6N/1.webp',
          'design system': 'https://i.ibb.co/rft2bf0T/9.webp',
          'mobile-first': 'https://i.ibb.co/gZ58PKyk/4.webp',
          'Shopify': 'https://i.ibb.co/ynjWYqv8/2.webp',
          'consumer engagement': 'https://i.ibb.co/Y7pGqJ69/5.webp',
          'rewards program': 'https://i.ibb.co/yB4RwkTf/7.webp',
          
          // Contact / Misc
          'LinkedIn': 'https://i.ibb.co/LXmyD2hq/IMG-20170104-184947-650.webp',
          'photos of mine': 'https://i.ibb.co/mCK7D4Xb/1-Oen-HCQm-Ga10wp-Cz-R8o9-Pt-A.webp'
      };
      
      // Precompile regex patterns for performance
      const phraseRegexMap = new Map();
      Object.keys(imageMap).forEach(phrase => {
          const escapedPhrase = phrase.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
          phraseRegexMap.set(phrase, new RegExp(`\\b${escapedPhrase}\\b`, 'gi'));
      });
      
      // ===================================
      // DATA: NARRATIVE CONTENT
      // ===================================
      const narrative = `UX is dead. Long live the Product Experience. Welcome to the portfolio of Zack Gort. [Digital Experience Designer]
      //
      I think. I make. I think about design and data as systems. I think about business requirements and better ways to build. I think about form and function. I make things too. I've made websites for people to find money. I've made websites for people to spend money. I've made websites for people to invest money. Now, as for design, I design those experiences. [I didn't use AI to build this website, per-se. It was human blood, sweat, and copious amounts of caffeine.] My toolkit includes Figma, Adobe CS, and a whiteboard. I specialize in User Experience Design, Visual Interface Design, Accessibility Compliance, and Creative Coding. I have built for brands like TikTok For Business, BNY Mellon, and GNC.
      //
      The client was BNY Melon ‚Äî Pershing X. [Agency: Publicis Sapient] The mission was clear: Design systems, dashboards, data, & due diligence. I served as Senior User Experience Designer and Product Design Lead (IA/flows) for Wove‚Äôs advisor experience. I partnered with the PM, Tech Lead, Data, Compliance, and designers to ship unified, cross-workflow journeys. The problem? Advisors worked across many disconnected tools; context was lost and data had to be re-entered. We sought to flatten the experience through a uniform and interconnected dashboard. [No Artificial Intelligence Here. This was only 2023 into 2024, before the buzzword craze.] It was human effort that did the due diligence of analyzing every legacy application, mapping that out, and shipping a viable modernized financial product ecosystem. The outcome? Wove launched with BNY Mellon power, scale, and security, helping advisors work faster and serve more clients.
      //
      General Nutrition Centers. [Agency: Elva Design Group] This is the Whey. As part of a total overhaul and overcoming a recent bankruptcy, GNC asked us to shake things up. We provided them with a modern and modular e-commerce solution through a ground-up build on the Shopify platform. My role was Senior User Experience Designer. Scope included diving deep into GNC's e-commerce ecosystem. From market research to user data to wireframe feature prototyping. We built a modular component-based design system optimized for continued optimization. It was a heavy lift with huge gains; a 12-week engagement meant tight cadence, fast-on-our-feet design strategy, and weekly executive reviews. We introduced a modern mobile-first navigation schema and retail taxonomy strategy. The result helped GNC reclaim ~$500M in annual revenue. [If the bar ain't bending, you‚Äôre just pretending.]
      //
      Yeah, so if any creative teams out there are hiring, hit me up on LinkedIn. Or you can just stay here and enjoy some photos of mine.`;
      
      // ===================================
      // UTILITY FUNCTIONS
      // ===================================
      const Utils = {
          debounce(func, wait) {
              let timeout;
              return function executedFunction(...args) {
                  const later = () => {
                      clearTimeout(timeout);
                      func(...args);
                  };
                  clearTimeout(timeout);
                  timeout = setTimeout(later, wait);
              };
          },
      
          throttle(func, limit) {
              let inThrottle;
              return function(...args) {
                  if (!inThrottle) {
                      func.apply(this, args);
                      inThrottle = true;
                      setTimeout(() => inThrottle = false, limit);
                  }
              };
          },
      
          $(selector) {
              return document.querySelector(selector);
          },
      
          $$(selector) {
              return Array.from(document.querySelectorAll(selector));
          }
      };
      
      // ===================================
      // TOUCH DETECTION
      // ===================================
      function detectTouch() {
          window.addEventListener('touchstart', () => {
              state.lastInteractionWasTouch = true;
              state.isTouch = true;
          }, { passive: true });
      
          window.addEventListener('mousedown', () => {
              state.lastInteractionWasTouch = false;
              state.isTouch = false;
          }, { passive: true });
      }
      
      // ===================================
      // NARRATIVE PARSING
      // ===================================
      function parseNarrative(text) {
          const parts = [];
          let idCounter = 0;
          
          const segments = text.split(/(\[|\])/);
          let inBracket = false;
          let bracketId = null;
          
          for (let i = 0; i < segments.length; i++) {
              const segment = segments[i];
              
              if (segment === '[') {
                  inBracket = true;
                  bracketId = idCounter++;
                  parts.push({ type: 'bracket', id: bracketId, content: '' });
              } else if (segment === ']') {
                  inBracket = false;
                  bracketId = null;
              } else if (segment.length > 0) {
                  if (inBracket && bracketId !== null) {
                      const bracket = parts.find(p => p.id === bracketId);
                      if (bracket) bracket.content = segment.trim();
                  } else {
                      const lineSegments = segment.split(/(\/\/|\/)/);
                      
                      for (let j = 0; j < lineSegments.length; j++) {
                          const lineSegment = lineSegments[j];
                          
                          if (lineSegment === '//') {
                              parts.push({ type: 'line-break', id: idCounter++, breakType: 'double' });
                          } else if (lineSegment === '/') {
                              parts.push({ type: 'line-break', id: idCounter++, breakType: 'single' });
                          } else if (lineSegment.trim()) {
                              const sentences = lineSegment.split(/(?<=[.!?])\s+/);
                              sentences.forEach(sentence => {
                                  const trimmedSentence = sentence.trim();
                                  if (!trimmedSentence) return;
                                  
                                  if (/^\(\d+\)\s/.test(trimmedSentence)) {
                                      const match = trimmedSentence.match(/^\((\d+)\)\s(.+)/);
                                      if (match) {
                                          parts.push({ 
                                              type: 'numbered-bullet', 
                                              id: idCounter++, 
                                              number: match[1],
                                              text: match[2].trim() 
                                          });
                                          return;
                                      }
                                  }
                                  
                                  if (trimmedSentence.startsWith('* ')) {
                                      parts.push({ 
                                          type: 'bullet', 
                                          id: idCounter++, 
                                          text: trimmedSentence.substring(2).trim() 
                                      });
                                      return;
                                  }
                                  
                                  parts.push({ type: 'sentence', id: idCounter++, text: trimmedSentence });
                              });
                          }
                      }
                  }
              }
          }
          return parts;
      }
      
      // ===================================
      // IMAGE HANDLING
      // ===================================
      function wrapImageTriggers(text) {
          let wrapped = text;
          for (const [phrase, url] of Object.entries(imageMap)) {
              const regex = phraseRegexMap.get(phrase);
              if (regex) {
                  wrapped = wrapped.replace(regex, `<span class="image-trigger" data-image="${url}">$&</span>`);
              }
          }
          return wrapped;
      }
      
      function preloadImages() {
          const imageUrls = [...new Set(Object.values(imageMap))];
          imageUrls.forEach(url => {
              const img = new Image();
              img.src = url;
          });
      }
      
      function showImage(imageUrl, triggerElement) {
          cursor.currentImageElement = triggerElement;
          state.imageActive = true;
          state.currentTriggerRect = triggerElement.getBoundingClientRect();
          document.body.classList.add('image-active');
          
          if (state.previewMode === 'cursor') {
              cursor.imageElement.src = imageUrl;
              cursor.imageElement.classList.add('active');
              cursor.element.classList.add('has-image');
          } else {
              const hoverImage = Utils.$('#hoverImage');
              const hoverImageImg = Utils.$('#hoverImageImg');
              
              if (state.imageTimeout) clearTimeout(state.imageTimeout);
              
              state.imageTimeout = setTimeout(() => {
                  hoverImageImg.onload = () => hoverImage.classList.add('active');
                  hoverImageImg.onerror = () => hoverImage.classList.add('active');
                  hoverImageImg.src = imageUrl;
              }, CONFIG.IMAGE_HOVER_DELAY);
          }
      }
      
      function hideImage() {
          const hoverImage = Utils.$('#hoverImage');
          
          if (state.imageTimeout) clearTimeout(state.imageTimeout);
          
          hoverImage.classList.remove('active');
          cursor.imageElement.classList.remove('active', 'enlarged');
          cursor.element.classList.remove('has-image');
          document.body.classList.remove('image-active');
          
          state.imageActive = false;
          cursor.currentImageElement = null;
          state.currentTriggerRect = null;
      }
      
      function toggleImageSize() {
          if (!state.imageActive || state.previewMode !== 'cursor') return;
          cursor.imageElement.classList.toggle('enlarged');
      }
      
      // ===================================
      // CHAPTER MANAGEMENT
      // ===================================
      function getCurrentChapter() {
          if (state.allSentenceElements.length === 0) return 0;
          for (let i = chapters.length - 1; i >= 0; i--) {
              if (state.currentSentenceIndex >= state.chapterStartIndices[i]) return i;
          }
          return 0;
      }
      
      function goToChapter(chapterId) {
          const startIndex = state.chapterStartIndices[chapterId];
          if (startIndex !== undefined) {
              state.currentSentenceIndex = startIndex;
              highlightSentence(startIndex);
              closeChapterDropdown();
          }
      }
      
      function nextChapter() {
          const currentChapter = getCurrentChapter();
          if (currentChapter < chapters.length - 1) {
              goToChapter(currentChapter + 1);
          }
      }
      
      function previousChapter() {
          const currentChapter = getCurrentChapter();
          if (currentChapter > 0) {
              goToChapter(currentChapter - 1);
          }
      }
      
      // ===================================
      // SENTENCE NAVIGATION
      // ===================================
      function nextSentence() {
          if (state.allSentenceElements.length === 0) return;
          state.currentSentenceIndex = (state.currentSentenceIndex + 1) % state.allSentenceElements.length;
          highlightSentence(state.currentSentenceIndex);
      }
      
      function previousSentence() {
          if (state.allSentenceElements.length === 0) return;
          state.currentSentenceIndex = (state.currentSentenceIndex - 1 + state.allSentenceElements.length) % state.allSentenceElements.length;
          highlightSentence(state.currentSentenceIndex);
      }
      
      function highlightSentence(index) {
          const sentence = state.allSentenceElements[index];
          if (!sentence) return;
          
          state.allSentenceElements.forEach(s => {
              s.classList.remove('active');
              s.classList.add('dimmed');
          });
          
          sentence.classList.add('active');
          sentence.classList.remove('dimmed');
          
          updateChapterProgress();
          updateChapterDropdown();
          
          sentence.scrollIntoView({ behavior: 'smooth', block: 'center' });
          
          const imageTrigger = sentence.querySelector('.image-trigger');
          if (imageTrigger) {
              const imageUrl = imageTrigger.getAttribute('data-image');
              if (imageUrl) showImage(imageUrl, imageTrigger);
          } else {
              hideImage();
          }
      }
      
      function resetToBeginning() {
          if (state.allSentenceElements.length === 0) return;
          state.currentSentenceIndex = 0;
          highlightSentence(0);
          window.scrollTo({ top: 0, behavior: 'smooth' });
      }
      
      // ===================================
      // UI UPDATE FUNCTIONS
      // ===================================
      function updateChapterProgress() {
          const currentChapter = getCurrentChapter();
          const bars = Utils.$$('.chapter-bar');
          
          bars.forEach(bar => {
              const chapterId = parseInt(bar.dataset.chapterId);
              bar.classList.remove('active', 'completed');
              
              if (chapterId === currentChapter) {
                  bar.classList.add('active');
              } else if (chapterId < currentChapter) {
                  bar.classList.add('completed');
              }
          });
          
          const total = state.allSentenceElements.length;
          const current = state.currentSentenceIndex + 1;
          const progress = (current / total) * 100;
          
          const mobileProgressFill = Utils.$('#mobileProgressFill');
          const mobileProgressText = Utils.$('#mobileProgressText');
          const landProgressFill = Utils.$('#landProgressFill');
          
          if (mobileProgressFill) mobileProgressFill.style.width = `${progress}%`;
          if (landProgressFill) landProgressFill.style.height = `${progress}%`;
          if (mobileProgressText) mobileProgressText.textContent = `${current} / ${total}`;
      }
      
      function updateChapterDropdown() {
          const currentChapter = getCurrentChapter();
          const items = Utils.$$('.chapter-item');
          
          items.forEach(item => {
              const chapterId = parseInt(item.dataset.chapterId);
              if (chapterId === currentChapter) {
                  item.classList.add('active');
                  if (isDropdownOpen()) {
                      item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
                  }
              } else {
                  item.classList.remove('active');
              }
          });
      }
      
      function initializeChapterProgress() {
          const container = Utils.$('#chapterProgressContainer');
          if (!container) return;
          
          container.innerHTML = '';
          let isRapidScrolling = false;
          let rapidScrollTimeout = null;
          
          chapters.forEach(chapter => {
              const bar = document.createElement('div');
              bar.className = 'chapter-bar';
              bar.dataset.chapterId = chapter.id;
              bar.dataset.chapterTitle = `${String(chapter.id + 1).padStart(2, '0')}. ${chapter.title}`;
              bar.title = chapter.title;
              
              bar.addEventListener('click', function(e) {
                  e.stopPropagation();
                  goToChapter(parseInt(this.dataset.chapterId));
              });
              
              bar.addEventListener('mouseenter', function() {
                  if (isRapidScrolling) {
                      goToChapter(parseInt(this.dataset.chapterId));
                  }
              });
              
              bar.addEventListener('mousedown', function(e) {
                  e.preventDefault();
                  isRapidScrolling = true;
                  if (rapidScrollTimeout) clearTimeout(rapidScrollTimeout);
              });
              
              container.appendChild(bar);
          });
          
          document.addEventListener('mouseup', function() {
              if (isRapidScrolling) {
                  isRapidScrolling = false;
                  if (rapidScrollTimeout) clearTimeout(rapidScrollTimeout);
                  rapidScrollTimeout = setTimeout(() => isRapidScrolling = false, 100);
              }
          });
          
          updateChapterProgress();
      }
      
      function buildChapterDropdown() {
          const dropdownList = Utils.$('#chapterDropdownList');
          dropdownList.innerHTML = '';
          
          chapters.forEach(chapter => {
              const startIndex = state.chapterStartIndices[chapter.id];
              const endIndex = chapter.id < chapters.length - 1 
                  ? state.chapterStartIndices[chapter.id + 1] 
                  : state.allSentenceElements.length;
              
              const li = document.createElement('li');
              li.className = 'chapter-item';
              li.dataset.chapterId = chapter.id;
              li.innerHTML = `
                  <span class="chapter-item-number">${String(chapter.id + 1).padStart(2, '0')}</span>
                  <span class="chapter-item-title">${chapter.title}</span>
                  <span class="chapter-item-progress">${endIndex - startIndex} sentences</span>
              `;
              li.addEventListener('click', () => goToChapter(chapter.id));
              dropdownList.appendChild(li);
          });
      }
      
      // ===================================
      // DROPDOWN MANAGEMENT
      // ===================================
      function isDropdownOpen() {
          return Utils.$('#chapterDropdown').classList.contains('open');
      }
      
      function toggleChapterDropdown() {
          const brand = Utils.$('#brandLogo');
          const dropdown = Utils.$('#chapterDropdown');
          
          brand.classList.toggle('open');
          dropdown.classList.toggle('open');
          
          if (dropdown.classList.contains('open')) {
              updateChapterDropdown();
          }
      }
      
      function closeChapterDropdown() {
          Utils.$('#brandLogo').classList.remove('open');
          Utils.$('#chapterDropdown').classList.remove('open');
      }
      
      // ===================================
      // IMAGE GRID
      // ===================================
      function isGridOpen() {
          return Utils.$('#imageGridOverlay').classList.contains('open');
      }
      
      function toggleImageGrid() {
          const overlay = Utils.$('#imageGridOverlay');
          const btns = Utils.$$('.grid-toggle-btn');
          
          if (overlay.classList.contains('open')) {
              overlay.classList.remove('open');
              document.body.classList.remove('grid-open');
              document.body.style.overflow = '';
              btns.forEach(btn => btn.querySelector('span:last-child').textContent = '‚ñ¶');
          } else {
              overlay.classList.add('open');
              document.body.classList.add('grid-open');
              document.body.style.overflow = 'hidden';
              btns.forEach(btn => btn.querySelector('span:last-child').textContent = '‚úï');
              buildImageGrid();
          }
      }
      
      function buildImageGrid() {
          const content = Utils.$('#gridContent');
          content.innerHTML = '';
          
          const imagesByChapter = {};
          state.gridImages.forEach(imgData => {
              if (!imagesByChapter[imgData.chapterId]) {
                  imagesByChapter[imgData.chapterId] = [];
              }
              imagesByChapter[imgData.chapterId].push(imgData);
          });
          
          chapters.forEach(chapter => {
              if (imagesByChapter[chapter.id] && imagesByChapter[chapter.id].length > 0) {
                  const section = document.createElement('div');
                  section.className = 'grid-chapter-section';
                  section.innerHTML = `<div class="grid-chapter-title">Chapter ${String(chapter.id + 1).padStart(2, '0')} ¬∑ ${chapter.title}</div>`;
                  
                  const grid = document.createElement('div');
                  grid.className = 'grid-images-container';
                  
                  imagesByChapter[chapter.id].forEach(imgData => {
                      const item = document.createElement('div');
                      item.className = 'grid-image-item';
                      item.innerHTML = `
                          <img src="${imgData.url}" loading="lazy" alt="Grid preview">
                          <div class="grid-image-caption">
                              <span class="caption-text">${imgData.text}</span>
                          </div>
                      `;
                      item.addEventListener('click', () => {
                          toggleImageGrid();
                          state.currentSentenceIndex = imgData.index;
                          highlightSentence(imgData.index);
                      });
                      grid.appendChild(item);
                  });
                  
                  section.appendChild(grid);
                  content.appendChild(section);
              }
          });
      }
      
      // ===================================
      // SCROLL HANDLING
      // ===================================
      function handleScroll(event) {
          if (state.scrollCooldownActive) return;
          if (event.target.closest('.chapter-dropdown-list, .image-grid-overlay')) return;
          if (isDropdownOpen()) {
              event.preventDefault();
              return;
          }
          if (isGridOpen()) return;
          
          const scrollDelta = event.deltaY;
          if (Math.abs(scrollDelta) >= CONFIG.SCROLL_THRESHOLD) {
              state.scrollCooldownActive = true;
              
              if (scrollDelta > 0) nextSentence();
              else previousSentence();
              
              setTimeout(() => {
                  state.scrollCooldownActive = false;
              }, CONFIG.SCROLL_COOLDOWN);
          }
          
          event.preventDefault();
      }
      
      // ===================================
      // TOUCH HANDLING
      // ===================================
      function handleTouchStart(e) {
          state.touchStartY = e.touches[0].clientY;
          state.touchStartX = e.touches[0].clientX;
          state.touchMoved = false;
      }
      
      function handleTouchMove(e) {
          state.touchMoved = true;
          
          if (e.target.closest('.chapter-dropdown-list, .image-grid-overlay')) return;
          if (isDropdownOpen()) {
              e.preventDefault();
              return;
          }
          if (isGridOpen()) return;
          
          e.preventDefault();
      }
      
      function handleTouchEnd(e) {
          if (!state.touchMoved || state.scrollCooldownActive || isDropdownOpen() || isGridOpen()) return;
          
          const touchEndY = e.changedTouches[0].clientY;
          const deltaY = state.touchStartY - touchEndY;
          
          if (Math.abs(deltaY) > CONFIG.FLICK_THRESHOLD) {
              state.scrollCooldownActive = true;
              
              if (deltaY > 0) nextSentence();
              else previousSentence();
              
              setTimeout(() => {
                  state.scrollCooldownActive = false;
              }, CONFIG.SCROLL_COOLDOWN);
          }
      }
      
      // ===================================
      // PARALLAX UPDATES
      // ===================================
      function updateParallax() {
          const viewportCenterX = window.innerWidth / 2;
          const viewportCenterY = window.innerHeight / 2;
          
          const mouseOffsetX = (state.mouseX - viewportCenterX) / viewportCenterX;
          const mouseOffsetY = (state.mouseY - viewportCenterY) / viewportCenterY;
          
          parallax.text.targetX = mouseOffsetX * 20 * CONFIG.TEXT_PARALLAX_STRENGTH;
          parallax.text.targetY = mouseOffsetY * 20 * CONFIG.TEXT_PARALLAX_STRENGTH;
          
          if (state.imageActive && state.currentTriggerRect) {
              const trigger = state.currentTriggerRect;
              const triggerCenterX = trigger.left + trigger.width / 2;
              const triggerCenterY = trigger.top + trigger.height / 2;
              
              const distToCenterX = (viewportCenterX - triggerCenterX) / viewportCenterX;
              const distToCenterY = (viewportCenterY - triggerCenterY) / viewportCenterY;
              
              const magnetX = distToCenterX * CONFIG.CENTER_MAGNET_STRENGTH * 100;
              const magnetY = distToCenterY * CONFIG.CENTER_MAGNET_STRENGTH * 100;
              
              parallax.image.targetX = (mouseOffsetX * 100 * CONFIG.IMAGE_PARALLAX_STRENGTH) - magnetX;
              parallax.image.targetY = (mouseOffsetY * 100 * CONFIG.IMAGE_PARALLAX_STRENGTH) - magnetY;
          } else {
              parallax.image.targetX = 0;
              parallax.image.targetY = 0;
          }
          
          parallax.text.x += (parallax.text.targetX - parallax.text.x) * CONFIG.PARALLAX_DAMPING;
          parallax.text.y += (parallax.text.targetY - parallax.text.y) * CONFIG.PARALLAX_DAMPING;
          parallax.image.x += (parallax.image.targetX - parallax.image.x) * CONFIG.PARALLAX_DAMPING;
          parallax.image.y += (parallax.image.targetY - parallax.image.y) * CONFIG.PARALLAX_DAMPING;
          
          const textLayer = Utils.$('#textLayer');
          const imageLayer = Utils.$('#imageLayer');
          const gridOverlay = Utils.$('#gridContent');
          
          if (textLayer) {
              textLayer.style.transform = `translate3d(${parallax.text.x}px, ${parallax.text.y}px, 0)`;
          }
          if (imageLayer) {
              imageLayer.style.transform = `translate3d(${parallax.image.x}px, ${parallax.image.y}px, 0)`;
          }
          if (gridOverlay) {
              gridOverlay.style.transform = `translate3d(${parallax.image.x * 0.5}px, ${parallax.image.y * 0.5}px, 0)`;
          }
          
          requestAnimationFrame(updateParallax);
      }
      
      // ===================================
      // CURSOR UPDATES
      // ===================================
      function updateCursor() {
          if (!cursor.element) return;
          
          cursor.x += (cursor.targetX - cursor.x) * CONFIG.CURSOR_SMOOTHING;
          cursor.y += (cursor.targetY - cursor.y) * CONFIG.CURSOR_SMOOTHING;
          
          cursor.element.style.transform = `translate3d(${cursor.x}px, ${cursor.y}px, 0) translate(-50%, -50%)`;
          
          if (cursor.imageElement) {
              cursor.imageElement.style.transform = `translate3d(${cursor.x}px, ${cursor.y}px, 0) translate(-50%, -50%)`;
          }
          
          requestAnimationFrame(updateCursor);
      }
      
      // ===================================
      // RENDER FUNCTION
      // ===================================
      function render() {
          const streamEl = Utils.$('#stream');
          const parsedContent = parseNarrative(narrative);
          const fragment = document.createDocumentFragment();
          
          state.allSentenceElements = [];
          state.gridImages = [];
          
          // Pre-calculate chapter positions by finding start text in raw narrative
          state.chapterStartIndices = new Array(chapters.length).fill(-1);
          chapters.forEach(chapter => {
              const index = narrative.indexOf(chapter.startText);
              if (index !== -1) {
                  state.chapterStartIndices[chapter.id] = index; // Store character position temporarily
              }
          });
          
          let sentenceCount = 0;
          let narrativePosition = 0;
          let nextChapterIndex = 0;
          let currentActiveChapter = 0;
      
          parsedContent.forEach(part => {
              // Check if we've reached a new chapter based on narrative position
              if (nextChapterIndex < chapters.length) {
                  const nextChapter = chapters[nextChapterIndex];
                  const textContent = part.type === 'sentence' || part.type === 'bullet' || part.type === 'numbered-bullet' 
                      ? part.text 
                      : (part.type === 'bracket' ? part.content : '');
                  
                  if (textContent && textContent.includes(nextChapter.startText)) {
                      state.chapterStartIndices[nextChapter.id] = sentenceCount;
                      
                      const chapterBreak = document.createElement('div');
                      chapterBreak.className = 'chapter-break';
                      chapterBreak.dataset.chapterId = nextChapter.id;
                      chapterBreak.innerHTML = `
                          <span class="chapter-number">Chapter ${String(nextChapter.id + 1).padStart(2, '0')}</span>
                          <span class="chapter-title">${nextChapter.title}</span>
                      `;
                      chapterBreak.addEventListener('click', () => goToChapter(nextChapter.id));
                      fragment.appendChild(chapterBreak);
                      
                      currentActiveChapter = nextChapter.id;
                      nextChapterIndex++;
                  }
              }
      
              if (part.type === 'sentence') {
                  const span = document.createElement('span');
                  span.className = 'sentence';
                  span.dataset.sentenceIndex = sentenceCount;
                  span.style.cursor = 'pointer';
                  
                  // Check for associated images
                  for (const [phrase, url] of Object.entries(imageMap)) {
                      if (part.text.includes(phrase)) {
                          state.gridImages.push({
                              index: sentenceCount,
                              text: part.text,
                              url: url,
                              chapterId: currentActiveChapter
                          });
                          break;
                      }
                  }
      
                  span.innerHTML = wrapImageTriggers(part.text) + ' ';
                  
                  span.addEventListener('mouseenter', () => {
                      const index = parseInt(span.dataset.sentenceIndex);
                      state.allSentenceElements.forEach((s, i) => {
                          s.style.opacity = i === index ? '0.7' : '0.25';
                      });
                  }, { passive: true });
                  
                  span.addEventListener('mouseleave', () => {
                      state.allSentenceElements.forEach(s => s.style.opacity = '');
                  }, { passive: true });
                  
                  span.addEventListener('click', () => {
                      state.currentSentenceIndex = parseInt(span.dataset.sentenceIndex);
                      highlightSentence(state.currentSentenceIndex);
                  });
                  
                  state.allSentenceElements.push(span);
                  sentenceCount++;
                  fragment.appendChild(span);
              } else if (part.type === 'line-break') {
                  const br = document.createElement('span');
                  br.className = 'line-break-spacer';
                  br.innerHTML = part.breakType === 'double' ? '<br><br>' : '<br>';
                  fragment.appendChild(br);
              } else if (part.type === 'bullet') {
                  const li = document.createElement('div');
                  li.className = 'sentence bullet-item';
                  li.dataset.sentenceIndex = sentenceCount;
                  li.style.cursor = 'pointer';
                  
                  for (const [phrase, url] of Object.entries(imageMap)) {
                      if (part.text.includes(phrase)) {
                          state.gridImages.push({
                              index: sentenceCount,
                              text: part.text,
                              url: url,
                              chapterId: currentActiveChapter
                          });
                          break;
                      }
                  }
                  
                  li.innerHTML = '<span class="bullet-marker">‚Ä¢</span> ' + wrapImageTriggers(part.text);
                  
                  li.addEventListener('mouseenter', () => {
                      const index = parseInt(li.dataset.sentenceIndex);
                      state.allSentenceElements.forEach((s, i) => {
                          s.style.opacity = i === index ? '0.7' : '0.25';
                      });
                  }, { passive: true });
                  
                  li.addEventListener('mouseleave', () => {
                      state.allSentenceElements.forEach(s => s.style.opacity = '');
                  }, { passive: true });
                  
                  li.addEventListener('click', () => {
                      state.currentSentenceIndex = parseInt(li.dataset.sentenceIndex);
                      highlightSentence(state.currentSentenceIndex);
                  });
                  
                  state.allSentenceElements.push(li);
                  sentenceCount++;
                  fragment.appendChild(li);
              } else if (part.type === 'numbered-bullet') {
                  const li = document.createElement('div');
                  li.className = 'sentence numbered-bullet-item';
                  li.dataset.sentenceIndex = sentenceCount;
                  li.style.cursor = 'pointer';
                  
                  for (const [phrase, url] of Object.entries(imageMap)) {
                      if (part.text.includes(phrase)) {
                          state.gridImages.push({
                              index: sentenceCount,
                              text: part.text,
                              url: url,
                              chapterId: currentActiveChapter
                          });
                          break;
                      }
                  }
                  
                  li.innerHTML = `<span class="numbered-marker">${part.number}.</span> ` + wrapImageTriggers(part.text);
                  
                  li.addEventListener('mouseenter', () => {
                      const index = parseInt(li.dataset.sentenceIndex);
                      state.allSentenceElements.forEach((s, i) => {
                          s.style.opacity = i === index ? '0.7' : '0.25';
                      });
                  }, { passive: true });
                  
                  li.addEventListener('mouseleave', () => {
                      state.allSentenceElements.forEach(s => s.style.opacity = '');
                  }, { passive: true });
                  
                  li.addEventListener('click', () => {
                      state.currentSentenceIndex = parseInt(li.dataset.sentenceIndex);
                      highlightSentence(state.currentSentenceIndex);
                  });
                  
                  state.allSentenceElements.push(li);
                  sentenceCount++;
                  fragment.appendChild(li);
              } else if (part.type === 'bracket') {
                  const trigger = document.createElement('button');
                  trigger.className = 'bracket-trigger';
                  trigger.textContent = '[+]';
                  const contentId = `bracket-content-${part.id}`;
                  trigger.setAttribute('aria-controls', contentId);
                  
                  const content = document.createElement('span');
                  content.className = 'bracket-content';
                  content.id = contentId;
                  content.textContent = ' ' + part.content + ' ';
                  
                  trigger.addEventListener('click', () => {
                      const isExpanded = content.classList.toggle('visible');
                      trigger.textContent = isExpanded ? '[‚àí]' : '[+]';
                      trigger.classList.toggle('expanded');
                      
                      if (isExpanded) {
                          state.expandedBrackets.add(part.id);
                      } else {
                          state.expandedBrackets.delete(part.id);
                      }
                  });
                  
                  fragment.appendChild(trigger);
                  fragment.appendChild(content);
              }
          });
          
          streamEl.innerHTML = '';
          streamEl.appendChild(fragment);
          
          buildChapterDropdown();
          initializeChapterProgress();
          
          // Event delegation for image triggers
          streamEl.addEventListener('mouseover', e => {
              const trigger = e.target.closest('.image-trigger');
              if (trigger) {
                  const imageUrl = trigger.getAttribute('data-image');
                  if (imageUrl) showImage(imageUrl, trigger);
              }
          }, { passive: true });
          
          streamEl.addEventListener('mouseout', e => {
              if (e.target.closest('.image-trigger')) {
                  hideImage();
              }
          }, { passive: true });
      }
      
      // ===================================
      // CONTEXT MENU
      // ===================================
      function initializeContextMenu() {
          const contextMenu = Utils.$('#contextMenu');
          
          function showContextMenu(x, y) {
              contextMenu.style.left = x + 'px';
              contextMenu.style.top = y + 'px';
              contextMenu.classList.add('open');
              contextMenu.setAttribute('aria-hidden', 'false');
              
              const themeText = Utils.$('#ctxThemeText');
              const themeIcon = Utils.$('#ctxThemeIcon');
              
              if (document.body.classList.contains('theme-academic')) {
                  themeText.textContent = 'Dark Theme';
                  themeIcon.textContent = 'üåô';
              } else if (document.body.classList.contains('theme-newspaper')) {
                  themeText.textContent = 'Academic Theme';
                  themeIcon.textContent = 'üìñ';
              } else {
                  themeText.textContent = 'Newspaper Theme';
                  themeIcon.textContent = '‚òÄÔ∏è';
              }
      
              const rect = contextMenu.getBoundingClientRect();
              if (rect.right > window.innerWidth) {
                  contextMenu.style.left = (window.innerWidth - rect.width - 10) + 'px';
              }
              if (rect.bottom > window.innerHeight) {
                  contextMenu.style.top = (window.innerHeight - rect.height - 10) + 'px';
              }
          }
          
          function hideContextMenu() {
              contextMenu.classList.remove('open');
              contextMenu.setAttribute('aria-hidden', 'true');
          }
          
          // Desktop context menu - DISABLED
          document.addEventListener('contextmenu', e => {
              e.preventDefault(); // Just disable browser context menu
          });
      }
      
      // ===================================
      // LAYOUT & THEME FUNCTIONS
      // ===================================
      function toggleLayout() {
          state.layoutMode = state.layoutMode === 'layered' ? 'split' : 'layered';
          document.body.classList.remove('layout-layered', 'layout-split');
          document.body.classList.add(`layout-${state.layoutMode}`);
          Utils.$('.layout-icon').className = `layout-icon ${state.layoutMode}`;
          document.body.style.transition = 'all 0.5s cubic-bezier(0.25, 1, 0.5, 1)';
          setTimeout(() => document.body.style.transition = '', 500);
      }
      
      function toggleTheme() {
          const body = document.body;
          if (body.classList.contains('theme-academic')) {
              body.classList.remove('theme-academic');
          } else if (body.classList.contains('theme-newspaper')) {
              body.classList.remove('theme-newspaper');
              body.classList.add('theme-academic');
          } else {
              body.classList.add('theme-newspaper');
          }
          
          const icon = Utils.$('.theme-icon');
          icon.textContent = body.classList.contains('theme-academic') 
              ? 'üåô' 
              : (body.classList.contains('theme-newspaper') ? 'üìñ' : '‚òÄÔ∏è');
      }
      
      // ===================================
      // ACCESSIBILITY CONTROLS
      // ===================================
      function initializeAccessibility() {
          let accessibilityLevel = 2;
          const accessibilityLevels = [0, 0.25, 0.5, 0.75, 1];
          
          function applyAccessibilityLevel(level) {
              const value = accessibilityLevels[level];
              document.documentElement.style.setProperty('--curve-k', value * 3);
              document.documentElement.style.setProperty('--vig-opacity', Math.min(value * 2.4, 1.2));
              document.documentElement.style.setProperty('--edge-blur', (value * 20) + 'px');
              document.body.style.fontSize = ((1.3 - (value * 0.9)) * 100) + '%';
              
              Utils.$$('.level-indicator').forEach((el, i) => {
                  if (i === level) {
                      el.classList.add('active');
                  } else {
                      el.classList.remove('active');
                  }
              });
          }
          
          Utils.$('#accessibilityIncrease').addEventListener('click', () => {
              if (accessibilityLevel > 0) {
                  applyAccessibilityLevel(--accessibilityLevel);
              }
          });
          
          Utils.$('#accessibilityDecrease').addEventListener('click', () => {
              if (accessibilityLevel < accessibilityLevels.length - 1) {
                  applyAccessibilityLevel(++accessibilityLevel);
              }
          });
          
          applyAccessibilityLevel(accessibilityLevel);
      }
      
      // ===================================
      // LONG PRESS SETUP
      // ===================================
      function setupLongPress(buttonId, normalAction, longPressAction) {
          const button = Utils.$(`#${buttonId}`);
          if (!button) return;
          
          let longPressTimer = null;
          let longPressActivated = false;
      
          button.addEventListener('touchstart', () => {
              longPressActivated = false;
              longPressTimer = setTimeout(() => {
                  longPressActivated = true;
                  longPressAction();
                  if (navigator.vibrate) navigator.vibrate(50);
              }, CONFIG.LONG_PRESS_DURATION);
          }, { passive: true });
      
          button.addEventListener('touchend', (e) => {
              if (longPressTimer) clearTimeout(longPressTimer);
              if (longPressActivated) {
                  e.preventDefault();
              }
          }, { passive: false });
      
          button.addEventListener('touchcancel', () => {
              if (longPressTimer) clearTimeout(longPressTimer);
          }, { passive: true });
          
          button.addEventListener('click', (e) => {
              if (longPressActivated) {
                  e.preventDefault();
                  e.stopPropagation();
                  longPressActivated = false;
              } else {
                  normalAction();
              }
          });
      }
      
      // ===================================
      // CLOSE HOTSPOTS
      // ===================================
      function initializeCloseHotspots() {
          const gridCloseHotspot = Utils.$('#gridCloseHotspot');
          const rotateCloseHotspot = Utils.$('#rotateCloseHotspot');
          
          gridCloseHotspot.addEventListener('mouseenter', () => {
              cursor.element.classList.add('close-mode');
          });
          gridCloseHotspot.addEventListener('mouseleave', () => {
              cursor.element.classList.remove('close-mode');
          });
          gridCloseHotspot.addEventListener('click', () => {
              toggleImageGrid();
              cursor.element.classList.remove('close-mode');
          });
          
          rotateCloseHotspot.addEventListener('mouseenter', () => {
              cursor.element.classList.add('close-mode');
          });
          rotateCloseHotspot.addEventListener('mouseleave', () => {
              cursor.element.classList.remove('close-mode');
          });
          rotateCloseHotspot.addEventListener('click', () => {
              Utils.$('.rotate-warning').style.display = 'none';
              cursor.element.classList.remove('close-mode');
          });
      }
      
      // ===================================
      // KEYBOARD CONTROLS
      // ===================================
      function initializeKeyboardControls() {
          document.addEventListener('keydown', e => {
              if (e.code === 'Space') {
                  e.preventDefault();
                  if (!state.spacebarPressed) {
                      toggleImageSize();
                      state.spacebarPressed = true;
                  }
              } else if (e.key === 'ArrowDown' || e.key === 'j') {
                  e.preventDefault();
                  nextSentence();
              } else if (e.key === 'ArrowUp' || e.key === 'k') {
                  e.preventDefault();
                  previousSentence();
              } else if (e.key === '[') {
                  e.preventDefault();
                  previousChapter();
              } else if (e.key === ']') {
                  e.preventDefault();
                  nextChapter();
              } else if (e.key === 'l') {
                  toggleLayout();
              } else if (e.key.toLowerCase() === 't') {
                  toggleTheme();
              } else if (e.key === 'Home') {
                  e.preventDefault();
                  resetToBeginning();
              } else if (e.key === 'Escape' || e.key.toLowerCase() === 'x') {
                  closeChapterDropdown();
                  
                  if (isGridOpen()) {
                      toggleImageGrid();
                      cursor.element.classList.remove('close-mode');
                  } else if (Utils.$('.rotate-warning').style.display === 'flex') {
                      Utils.$('.rotate-warning').style.display = 'none';
                      cursor.element.classList.remove('close-mode');
                  } else if (state.layoutMode === 'split') {
                      toggleLayout();
                  }
              }
          });
          
          document.addEventListener('keyup', e => {
              if (e.code === 'Space') {
                  state.spacebarPressed = false;
              }
          });
      }
      
      // ===================================
      // INTERACTION HINT
      // ===================================
      function initializeInteractionHint() {
          let hintDismissed = false;
          const dismissHint = () => {
              if (!hintDismissed) {
                  document.body.classList.add('hint-shown');
                  hintDismissed = true;
              }
          };
          document.addEventListener('click', dismissHint, { once: true });
          document.addEventListener('touchstart', dismissHint, { once: true });
          setTimeout(dismissHint, 3000);
      }
      
      // ===================================
      // MAIN INITIALIZATION
      // ===================================
      document.addEventListener('DOMContentLoaded', () => {
          // Initialize cursor elements
          cursor.element = Utils.$('#cursor');
          cursor.imageElement = Utils.$('#cursorImage');
          
          // Cursor tracking
          document.addEventListener('mousemove', e => {
              cursor.targetX = e.clientX;
              cursor.targetY = e.clientY;
              state.mouseX = e.clientX;
              state.mouseY = e.clientY;
          }, { passive: true });
          
          // Cursor hover effects
          document.addEventListener('mouseover', e => {
              if (e.target.matches('a, button, .image-trigger, input[type="range"], .chapter-break, .chapter-item, .grid-image-item')) {
                  cursor.element.classList.add('hovering');
                  if (e.target.matches('button, a, .grid-image-item')) {
                      cursor.element.classList.add('pointer');
                  }
              }
          }, { passive: true });
          
          document.addEventListener('mouseout', e => {
              if (e.target.matches('a, button, .image-trigger, input[type="range"], .chapter-break, .chapter-item, .grid-image-item')) {
                  cursor.element.classList.remove('hovering', 'pointer');
              }
          }, { passive: true });
          
          // Initialize all modules
          detectTouch();
          initializeAccessibility();
          initializeContextMenu();
          initializeCloseHotspots();
          initializeKeyboardControls();
          initializeInteractionHint();
          
          // Event listeners
          Utils.$('#brandLogo').addEventListener('click', toggleChapterDropdown);
          Utils.$('#gridToggleBtn').addEventListener('click', toggleImageGrid);
          Utils.$('#layoutToggle').addEventListener('click', toggleLayout);
          Utils.$('#themeToggle').addEventListener('click', toggleTheme);
          
          Utils.$('#prevSentenceBtn').addEventListener('click', previousSentence);
          Utils.$('#nextSentenceBtn').addEventListener('click', nextSentence);
          
          document.addEventListener('click', e => {
              if (!Utils.$('#brandLogo').contains(e.target) && !Utils.$('#chapterDropdown').contains(e.target)) {
                  closeChapterDropdown();
              }
          });
          
          window.addEventListener('wheel', handleScroll, { passive: false });
          window.addEventListener('touchstart', handleTouchStart, { passive: true });
          window.addEventListener('touchmove', handleTouchMove, { passive: false });
          window.addEventListener('touchend', handleTouchEnd, { passive: true });
          
          // Setup long-press buttons
          setupLongPress('mobilePrevSentenceBtn', previousSentence, previousChapter);
          setupLongPress('mobileNextSentenceBtn', nextSentence, nextChapter);
          setupLongPress('landPrevBtn', previousSentence, previousChapter);
          setupLongPress('landNextBtn', nextSentence, nextChapter);
          
          // Initialize content
          preloadImages();
          render();
          
          // Start animations
          updateCursor();
          updateParallax();
          
          // Set initial layout
          document.body.classList.add(`layout-${state.layoutMode}`);
          
          // Start at first sentence
          if (state.allSentenceElements.length > 0) {
              state.currentSentenceIndex = 0;
              highlightSentence(0);
          }
          
          // Expose global functions for inline event handlers
          window.toggleLayout = toggleLayout;
          window.toggleTheme = toggleTheme;
      });
      </script>
</body>
</html>
